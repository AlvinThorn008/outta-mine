/*
 * Copyright (c) 2011 Erin Catto http://box2d.org
 *
 * This software is provided 'as-is', without any express or implied
 * warranty.  In no event will the authors be held liable for any damages
 * arising from the use of this software.
 * Permission is granted to anyone to use this software for any purpose,
 * including commercial applications, and to alter it and redistribute it
 * freely, subject to the following restrictions:
 * 1. The origin of this software must not be misrepresented; you must not
 * claim that you wrote the original software. If you use this software
 * in a product, an acknowledgment in the product documentation would be
 * appreciated but is not required.
 * 2. Altered source versions must be plainly marked as such, and must not be
 * misrepresented as being the original software.
 * 3. This notice may not be removed or altered from any source distribution.
 */
/// Color for debug drawing. Each value has the range [0,1].
export class b2Color {
    constructor(r = 0.5, g = 0.5, b = 0.5, a = 1.0) {
        this.r = NaN;
        this.g = NaN;
        this.b = NaN;
        this.a = NaN;
        this.r = r;
        this.g = g;
        this.b = b;
        this.a = a;
    }
    Clone() {
        return new b2Color().Copy(this);
    }
    Copy(other) {
        this.r = other.r;
        this.g = other.g;
        this.b = other.b;
        this.a = other.a;
        return this;
    }
    IsEqual(color) {
        return this.r === color.r && this.g === color.g && this.b === color.b && this.a === color.a;
    }
    IsZero() {
        return this.r === 0 && this.g === 0 && this.b === 0 && this.a === 0;
    }
    Set(r, g, b, a = this.a) {
        this.SetRGBA(r, g, b, a);
    }
    SetByteRGB(r, g, b) {
        this.r = r / 0xff;
        this.g = g / 0xff;
        this.b = b / 0xff;
        return this;
    }
    SetByteRGBA(r, g, b, a) {
        this.r = r / 0xff;
        this.g = g / 0xff;
        this.b = b / 0xff;
        this.a = a / 0xff;
        return this;
    }
    SetRGB(rr, gg, bb) {
        this.r = rr;
        this.g = gg;
        this.b = bb;
        return this;
    }
    SetRGBA(rr, gg, bb, aa) {
        this.r = rr;
        this.g = gg;
        this.b = bb;
        this.a = aa;
        return this;
    }
    SelfAdd(color) {
        this.r += color.r;
        this.g += color.g;
        this.b += color.b;
        this.a += color.a;
        return this;
    }
    Add(color, out) {
        out.r = this.r + color.r;
        out.g = this.g + color.g;
        out.b = this.b + color.b;
        out.a = this.a + color.a;
        return out;
    }
    SelfSub(color) {
        this.r -= color.r;
        this.g -= color.g;
        this.b -= color.b;
        this.a -= color.a;
        return this;
    }
    Sub(color, out) {
        out.r = this.r - color.r;
        out.g = this.g - color.g;
        out.b = this.b - color.b;
        out.a = this.a - color.a;
        return out;
    }
    SelfMul(s) {
        this.r *= s;
        this.g *= s;
        this.b *= s;
        this.a *= s;
        return this;
    }
    Mul(s, out) {
        out.r = this.r * s;
        out.g = this.g * s;
        out.b = this.b * s;
        out.a = this.a * s;
        return out;
    }
    Mix(mixColor, strength) {
        b2Color.MixColors(this, mixColor, strength);
    }
    static MixColors(colorA, colorB, strength) {
        const dr = strength * (colorB.r - colorA.r);
        const dg = strength * (colorB.g - colorA.g);
        const db = strength * (colorB.b - colorA.b);
        const da = strength * (colorB.a - colorA.a);
        colorA.r += dr;
        colorA.g += dg;
        colorA.b += db;
        colorA.a += da;
        colorB.r -= dr;
        colorB.g -= dg;
        colorB.b -= db;
        colorB.a -= da;
    }
    MakeStyleString(alpha = this.a) {
        return b2Color.MakeStyleString(this.r, this.g, this.b, alpha);
    }
    static MakeStyleString(r, g, b, a = 1.0) {
        // function clamp(x: number, lo: number, hi: number) { return x < lo ? lo : hi < x ? hi : x; }
        r *= 255; // r = clamp(r, 0, 255);
        g *= 255; // g = clamp(g, 0, 255);
        b *= 255; // b = clamp(b, 0, 255);
        // a = clamp(a, 0, 1);
        if (a < 1) {
            return `rgba(${r},${g},${b},${a})`;
        }
        else {
            return `rgb(${r},${g},${b})`;
        }
    }
}
b2Color.ZERO = new b2Color(0, 0, 0, 0);
b2Color.RED = new b2Color(1, 0, 0);
b2Color.GREEN = new b2Color(0, 1, 0);
b2Color.BLUE = new b2Color(0, 0, 1);
/// Implement and register this class with a b2World to provide debug drawing of physics
/// entities in your game.
export class b2Draw {
    constructor() {
        this.m_drawFlags = 0 /* e_none */;
    }
    SetFlags(flags) {
        this.m_drawFlags = flags;
    }
    GetFlags() {
        return this.m_drawFlags;
    }
    AppendFlags(flags) {
        this.m_drawFlags |= flags;
    }
    ClearFlags(flags) {
        this.m_drawFlags &= ~flags;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYjJEcmF3LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvbW1vbi9iMkRyYXcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7R0FnQkc7QUFjSCw0REFBNEQ7QUFDNUQsTUFBTSxPQUFPLE9BQU87SUFXbEIsWUFBWSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQyxHQUFHLEdBQUcsRUFBRSxDQUFDLEdBQUcsR0FBRztRQUw5QyxNQUFDLEdBQUcsR0FBRyxDQUFDO1FBQ1IsTUFBQyxHQUFHLEdBQUcsQ0FBQztRQUNSLE1BQUMsR0FBRyxHQUFHLENBQUM7UUFDUixNQUFDLEdBQUcsR0FBRyxDQUFDO1FBR04sSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDWCxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNYLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ1gsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDYixDQUFDO0lBRUQsS0FBSztRQUNILE9BQU8sSUFBSSxPQUFPLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbEMsQ0FBQztJQUVELElBQUksQ0FBQyxLQUFXO1FBQ2QsSUFBSSxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ2pCLElBQUksQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUNqQixJQUFJLENBQUMsQ0FBQyxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDakIsSUFBSSxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ2pCLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELE9BQU8sQ0FBQyxLQUFXO1FBQ2pCLE9BQU8sSUFBSSxDQUFDLENBQUMsS0FBSyxLQUFLLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FB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MUIsTUFBTSxPQUFnQixNQUFNO0lBQTVCO1FBQ0UsZ0JBQVcsa0JBQXNCO0lBcUNuQyxDQUFDO0lBbkNDLFFBQVEsQ0FBQyxLQUFrQjtRQUN6QixJQUFJLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQztJQUMzQixDQUFDO0lBRUQsUUFBUTtRQUNOLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQztJQUMxQixDQUFDO0lBRUQsV0FBVyxDQUFDLEtBQWtCO1FBQzVCLElBQUksQ0FBQyxXQUFXLElBQUksS0FBSyxDQUFDO0lBQzVCLENBQUM7SUFFRCxVQUFVLENBQUMsS0FBa0I7UUFDM0IsSUFBSSxDQUFDLFdBQVcsSUFBSSxDQUFDLEtBQUssQ0FBQztJQUM3QixDQUFDO0NBcUJGIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogQ29weXJpZ2h0IChjKSAyMDExIEVyaW4gQ2F0dG8gaHR0cDovL2JveDJkLm9yZ1xyXG4gKlxyXG4gKiBUaGlzIHNvZnR3YXJlIGlzIHByb3ZpZGVkICdhcy1pcycsIHdpdGhvdXQgYW55IGV4cHJlc3Mgb3IgaW1wbGllZFxyXG4gKiB3YXJyYW50eS4gIEluIG5vIGV2ZW50IHdpbGwgdGhlIGF1dGhvcnMgYmUgaGVsZCBsaWFibGUgZm9yIGFueSBkYW1hZ2VzXHJcbiAqIGFyaXNpbmcgZnJvbSB0aGUgdXNlIG9mIHRoaXMgc29mdHdhcmUuXHJcbiAqIFBlcm1pc3Npb24gaXMgZ3JhbnRlZCB0byBhbnlvbmUgdG8gdXNlIHRoaXMgc29mdHdhcmUgZm9yIGFueSBwdXJwb3NlLFxyXG4gKiBpbmNsdWRpbmcgY29tbWVyY2lhbCBhcHBsaWNhdGlvbnMsIGFuZCB0byBhbHRlciBpdCBhbmQgcmVkaXN0cmlidXRlIGl0XHJcbiAqIGZyZWVseSwgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIHJlc3RyaWN0aW9uczpcclxuICogMS4gVGhlIG9yaWdpbiBvZiB0aGlzIHNvZnR3YXJlIG11c3Qgbm90IGJlIG1pc3JlcHJlc2VudGVkOyB5b3UgbXVzdCBub3RcclxuICogY2xhaW0gdGhhdCB5b3Ugd3JvdGUgdGhlIG9yaWdpbmFsIHNvZnR3YXJlLiBJZiB5b3UgdXNlIHRoaXMgc29mdHdhcmVcclxuICogaW4gYSBwcm9kdWN0LCBhbiBhY2tub3dsZWRnbWVudCBpbiB0aGUgcHJvZHVjdCBkb2N1bWVudGF0aW9uIHdvdWxkIGJlXHJcbiAqIGFwcHJlY2lhdGVkIGJ1dCBpcyBub3QgcmVxdWlyZWQuXHJcbiAqIDIuIEFsdGVyZWQgc291cmNlIHZlcnNpb25zIG11c3QgYmUgcGxhaW5seSBtYXJrZWQgYXMgc3VjaCwgYW5kIG11c3Qgbm90IGJlXHJcbiAqIG1pc3JlcHJlc2VudGVkIGFzIGJlaW5nIHRoZSBvcmlnaW5hbCBzb2Z0d2FyZS5cclxuICogMy4gVGhpcyBub3RpY2UgbWF5IG5vdCBiZSByZW1vdmVkIG9yIGFsdGVyZWQgZnJvbSBhbnkgc291cmNlIGRpc3RyaWJ1dGlvbi5cclxuICovXHJcblxyXG5pbXBvcnQgeyBiMlRyYW5zZm9ybSwgWFkgfSBmcm9tICcuL2IyTWF0aCc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFJHQiB7XHJcbiAgcjogbnVtYmVyO1xyXG4gIGc6IG51bWJlcjtcclxuICBiOiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUkdCQSBleHRlbmRzIFJHQiB7XHJcbiAgYTogbnVtYmVyO1xyXG59XHJcblxyXG4vLy8gQ29sb3IgZm9yIGRlYnVnIGRyYXdpbmcuIEVhY2ggdmFsdWUgaGFzIHRoZSByYW5nZSBbMCwxXS5cclxuZXhwb3J0IGNsYXNzIGIyQ29sb3IgaW1wbGVtZW50cyBSR0JBIHtcclxuICBzdGF0aWMgcmVhZG9ubHkgWkVSTzogUmVhZG9ubHk8YjJDb2xvcj4gPSBuZXcgYjJDb2xvcigwLCAwLCAwLCAwKTtcclxuXHJcbiAgc3RhdGljIHJlYWRvbmx5IFJFRDogUmVhZG9ubHk8YjJDb2xvcj4gPSBuZXcgYjJDb2xvcigxLCAwLCAwKTtcclxuICBzdGF0aWMgcmVhZG9ubHkgR1JFRU46IFJlYWRvbmx5PGIyQ29sb3I+ID0gbmV3IGIyQ29sb3IoMCwgMSwgMCk7XHJcbiAgc3RhdGljIHJlYWRvbmx5IEJMVUU6IFJlYWRvbmx5PGIyQ29sb3I+ID0gbmV3IGIyQ29sb3IoMCwgMCwgMSk7XHJcbiAgciA9IE5hTjtcclxuICBnID0gTmFOO1xyXG4gIGIgPSBOYU47XHJcbiAgYSA9IE5hTjtcclxuXHJcbiAgY29uc3RydWN0b3IociA9IDAuNSwgZyA9IDAuNSwgYiA9IDAuNSwgYSA9IDEuMCkge1xyXG4gICAgdGhpcy5yID0gcjtcclxuICAgIHRoaXMuZyA9IGc7XHJcbiAgICB0aGlzLmIgPSBiO1xyXG4gICAgdGhpcy5hID0gYTtcclxuICB9XHJcblxyXG4gIENsb25lKCk6IGIyQ29sb3Ige1xyXG4gICAgcmV0dXJuIG5ldyBiMkNvbG9yKCkuQ29weSh0aGlzKTtcclxuICB9XHJcblxyXG4gIENvcHkob3RoZXI6IFJHQkEpOiB0aGlzIHtcclxuICAgIHRoaXMuciA9IG90aGVyLnI7XHJcbiAgICB0aGlzLmcgPSBvdGhlci5nO1xyXG4gICAgdGhpcy5iID0gb3RoZXIuYjtcclxuICAgIHRoaXMuYSA9IG90aGVyLmE7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIElzRXF1YWwoY29sb3I6IFJHQkEpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLnIgPT09IGNvbG9yLnIgJiYgdGhpcy5nID09PSBjb2xvci5nICYmIHRoaXMuYiA9PT0gY29sb3IuYiAmJiB0aGlzLmEgPT09IGNvbG9yLmE7XHJcbiAgfVxyXG5cclxuICBJc1plcm8oKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5yID09PSAwICYmIHRoaXMuZyA9PT0gMCAmJiB0aGlzLmIgPT09IDAgJiYgdGhpcy5hID09PSAwO1xyXG4gIH1cclxuXHJcbiAgU2V0KHI6IG51bWJlciwgZzogbnVtYmVyLCBiOiBudW1iZXIsIGE6IG51bWJlciA9IHRoaXMuYSk6IHZvaWQge1xyXG4gICAgdGhpcy5TZXRSR0JBKHIsIGcsIGIsIGEpO1xyXG4gIH1cclxuXHJcbiAgU2V0Qnl0ZVJHQihyOiBudW1iZXIsIGc6IG51bWJlciwgYjogbnVtYmVyKTogdGhpcyB7XHJcbiAgICB0aGlzLnIgPSByIC8gMHhmZjtcclxuICAgIHRoaXMuZyA9IGcgLyAweGZmO1xyXG4gICAgdGhpcy5iID0gYiAvIDB4ZmY7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIFNldEJ5dGVSR0JBKHI6IG51bWJlciwgZzogbnVtYmVyLCBiOiBudW1iZXIsIGE6IG51bWJlcik6IHRoaXMge1xyXG4gICAgdGhpcy5yID0gciAvIDB4ZmY7XHJcbiAgICB0aGlzLmcgPSBnIC8gMHhmZjtcclxuICAgIHRoaXMuYiA9IGIgLyAweGZmO1xyXG4gICAgdGhpcy5hID0gYSAvIDB4ZmY7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIFNldFJHQihycjogbnVtYmVyLCBnZzogbnVtYmVyLCBiYjogbnVtYmVyKTogdGhpcyB7XHJcbiAgICB0aGlzLnIgPSBycjtcclxuICAgIHRoaXMuZyA9IGdnO1xyXG4gICAgdGhpcy5iID0gYmI7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIFNldFJHQkEocnI6IG51bWJlciwgZ2c6IG51bWJlciwgYmI6IG51bWJlciwgYWE6IG51bWJlcik6IHRoaXMge1xyXG4gICAgdGhpcy5yID0gcnI7XHJcbiAgICB0aGlzLmcgPSBnZztcclxuICAgIHRoaXMuYiA9IGJiO1xyXG4gICAgdGhpcy5hID0gYWE7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIFNlbGZBZGQoY29sb3I6IFJHQkEpOiB0aGlzIHtcclxuICAgIHRoaXMuciArPSBjb2xvci5yO1xyXG4gICAgdGhpcy5nICs9IGNvbG9yLmc7XHJcbiAgICB0aGlzLmIgKz0gY29sb3IuYjtcclxuICAgIHRoaXMuYSArPSBjb2xvci5hO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG5cclxuICBBZGQ8VCBleHRlbmRzIFJHQkE+KGNvbG9yOiBSR0JBLCBvdXQ6IFQpOiBUIHtcclxuICAgIG91dC5yID0gdGhpcy5yICsgY29sb3IucjtcclxuICAgIG91dC5nID0gdGhpcy5nICsgY29sb3IuZztcclxuICAgIG91dC5iID0gdGhpcy5iICsgY29sb3IuYjtcclxuICAgIG91dC5hID0gdGhpcy5hICsgY29sb3IuYTtcclxuICAgIHJldHVybiBvdXQ7XHJcbiAgfVxyXG5cclxuICBTZWxmU3ViKGNvbG9yOiBSR0JBKTogdGhpcyB7XHJcbiAgICB0aGlzLnIgLT0gY29sb3IucjtcclxuICAgIHRoaXMuZyAtPSBjb2xvci5nO1xyXG4gICAgdGhpcy5iIC09IGNvbG9yLmI7XHJcbiAgICB0aGlzLmEgLT0gY29sb3IuYTtcclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgU3ViPFQgZXh0ZW5kcyBSR0JBPihjb2xvcjogUkdCQSwgb3V0OiBUKTogVCB7XHJcbiAgICBvdXQuciA9IHRoaXMuciAtIGNvbG9yLnI7XHJcbiAgICBvdXQuZyA9IHRoaXMuZyAtIGNvbG9yLmc7XHJcbiAgICBvdXQuYiA9IHRoaXMuYiAtIGNvbG9yLmI7XHJcbiAgICBvdXQuYSA9IHRoaXMuYSAtIGNvbG9yLmE7XHJcbiAgICByZXR1cm4gb3V0O1xyXG4gIH1cclxuXHJcbiAgU2VsZk11bChzOiBudW1iZXIpOiB0aGlzIHtcclxuICAgIHRoaXMuciAqPSBzO1xyXG4gICAgdGhpcy5nICo9IHM7XHJcbiAgICB0aGlzLmIgKj0gcztcclxuICAgIHRoaXMuYSAqPSBzO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG5cclxuICBNdWw8VCBleHRlbmRzIFJHQkE+KHM6IG51bWJlciwgb3V0OiBUKTogVCB7XHJcbiAgICBvdXQuciA9IHRoaXMuciAqIHM7XHJcbiAgICBvdXQuZyA9IHRoaXMuZyAqIHM7XHJcbiAgICBvdXQuYiA9IHRoaXMuYiAqIHM7XHJcbiAgICBvdXQuYSA9IHRoaXMuYSAqIHM7XHJcbiAgICByZXR1cm4gb3V0O1xyXG4gIH1cclxuXHJcbiAgTWl4KG1peENvbG9yOiBSR0JBLCBzdHJlbmd0aDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBiMkNvbG9yLk1peENvbG9ycyh0aGlzLCBtaXhDb2xvciwgc3RyZW5ndGgpO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIE1peENvbG9ycyhjb2xvckE6IFJHQkEsIGNvbG9yQjogUkdCQSwgc3RyZW5ndGg6IG51bWJlcik6IHZvaWQge1xyXG4gICAgY29uc3QgZHIgPSBzdHJlbmd0aCAqIChjb2xvckIuciAtIGNvbG9yQS5yKTtcclxuICAgIGNvbnN0IGRnID0gc3RyZW5ndGggKiAoY29sb3JCLmcgLSBjb2xvckEuZyk7XHJcbiAgICBjb25zdCBkYiA9IHN0cmVuZ3RoICogKGNvbG9yQi5iIC0gY29sb3JBLmIpO1xyXG4gICAgY29uc3QgZGEgPSBzdHJlbmd0aCAqIChjb2xvckIuYSAtIGNvbG9yQS5hKTtcclxuICAgIGNvbG9yQS5yICs9IGRyO1xyXG4gICAgY29sb3JBLmcgKz0gZGc7XHJcbiAgICBjb2xvckEuYiArPSBkYjtcclxuICAgIGNvbG9yQS5hICs9IGRhO1xyXG4gICAgY29sb3JCLnIgLT0gZHI7XHJcbiAgICBjb2xvckIuZyAtPSBkZztcclxuICAgIGNvbG9yQi5iIC09IGRiO1xyXG4gICAgY29sb3JCLmEgLT0gZGE7XHJcbiAgfVxyXG5cclxuICBNYWtlU3R5bGVTdHJpbmcoYWxwaGE6IG51bWJlciA9IHRoaXMuYSk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gYjJDb2xvci5NYWtlU3R5bGVTdHJpbmcodGhpcy5yLCB0aGlzLmcsIHRoaXMuYiwgYWxwaGEpO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIE1ha2VTdHlsZVN0cmluZyhyOiBudW1iZXIsIGc6IG51bWJlciwgYjogbnVtYmVyLCBhID0gMS4wKTogc3RyaW5nIHtcclxuICAgIC8vIGZ1bmN0aW9uIGNsYW1wKHg6IG51bWJlciwgbG86IG51bWJlciwgaGk6IG51bWJlcikgeyByZXR1cm4geCA8IGxvID8gbG8gOiBoaSA8IHggPyBoaSA6IHg7IH1cclxuICAgIHIgKj0gMjU1OyAvLyByID0gY2xhbXAociwgMCwgMjU1KTtcclxuICAgIGcgKj0gMjU1OyAvLyBnID0gY2xhbXAoZywgMCwgMjU1KTtcclxuICAgIGIgKj0gMjU1OyAvLyBiID0gY2xhbXAoYiwgMCwgMjU1KTtcclxuICAgIC8vIGEgPSBjbGFtcChhLCAwLCAxKTtcclxuICAgIGlmIChhIDwgMSkge1xyXG4gICAgICByZXR1cm4gYHJnYmEoJHtyfSwke2d9LCR7Yn0sJHthfSlgO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIGByZ2IoJHtyfSwke2d9LCR7Yn0pYDtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBlbnVtIGIyRHJhd0ZsYWdzIHtcclxuICBlX25vbmUgPSAwLFxyXG4gIGVfc2hhcGVCaXQgPSAweDAwMDEsIC8vLzwgZHJhdyBzaGFwZXNcclxuICBlX2pvaW50Qml0ID0gMHgwMDAyLCAvLy88IGRyYXcgam9pbnQgY29ubmVjdGlvbnNcclxuICBlX2FhYmJCaXQgPSAweDAwMDQsIC8vLzwgZHJhdyBheGlzIGFsaWduZWQgYm91bmRpbmcgYm94ZXNcclxuICBlX3BhaXJCaXQgPSAweDAwMDgsIC8vLzwgZHJhdyBicm9hZC1waGFzZSBwYWlyc1xyXG4gIGVfY2VudGVyT2ZNYXNzQml0ID0gMHgwMDEwLCAvLy88IGRyYXcgY2VudGVyIG9mIG1hc3MgZnJhbWVcclxuICBlX3BhcnRpY2xlQml0ID0gMHgwMDIwLCAvLy88IGRyYXcgcGFydGljbGVzXHJcbiAgZV9jb250cm9sbGVyQml0ID0gMHgwMDQwLCAvLy8gQHNlZSBiMkNvbnRyb2xsZXIgbGlzdFxyXG4gIGVfYWxsID0gMHgwMDNmLFxyXG59XHJcblxyXG4vLy8gSW1wbGVtZW50IGFuZCByZWdpc3RlciB0aGlzIGNsYXNzIHdpdGggYSBiMldvcmxkIHRvIHByb3ZpZGUgZGVidWcgZHJhd2luZyBvZiBwaHlzaWNzXHJcbi8vLyBlbnRpdGllcyBpbiB5b3VyIGdhbWUuXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBiMkRyYXcge1xyXG4gIG1fZHJhd0ZsYWdzID0gYjJEcmF3RmxhZ3MuZV9ub25lO1xyXG5cclxuICBTZXRGbGFncyhmbGFnczogYjJEcmF3RmxhZ3MpOiB2b2lkIHtcclxuICAgIHRoaXMubV9kcmF3RmxhZ3MgPSBmbGFncztcclxuICB9XHJcblxyXG4gIEdldEZsYWdzKCk6IGIyRHJhd0ZsYWdzIHtcclxuICAgIHJldHVybiB0aGlzLm1fZHJhd0ZsYWdzO1xyXG4gIH1cclxuXHJcbiAgQXBwZW5kRmxhZ3MoZmxhZ3M6IGIyRHJhd0ZsYWdzKTogdm9pZCB7XHJcbiAgICB0aGlzLm1fZHJhd0ZsYWdzIHw9IGZsYWdzO1xyXG4gIH1cclxuXHJcbiAgQ2xlYXJGbGFncyhmbGFnczogYjJEcmF3RmxhZ3MpOiB2b2lkIHtcclxuICAgIHRoaXMubV9kcmF3RmxhZ3MgJj0gfmZsYWdzO1xyXG4gIH1cclxuXHJcbiAgYWJzdHJhY3QgUHVzaFRyYW5zZm9ybSh4ZjogYjJUcmFuc2Zvcm0pOiB2b2lkO1xyXG5cclxuICBhYnN0cmFjdCBQb3BUcmFuc2Zvcm0oeGY6IGIyVHJhbnNmb3JtKTogdm9pZDtcclxuXHJcbiAgYWJzdHJhY3QgRHJhd1BvbHlnb24odmVydGljZXM6IFhZW10sIHZlcnRleENvdW50OiBudW1iZXIsIGNvbG9yOiBSR0JBKTogdm9pZDtcclxuXHJcbiAgYWJzdHJhY3QgRHJhd1NvbGlkUG9seWdvbih2ZXJ0aWNlczogWFlbXSwgdmVydGV4Q291bnQ6IG51bWJlciwgY29sb3I6IFJHQkEpOiB2b2lkO1xyXG5cclxuICBhYnN0cmFjdCBEcmF3Q2lyY2xlKGNlbnRlcjogWFksIHJhZGl1czogbnVtYmVyLCBjb2xvcjogUkdCQSk6IHZvaWQ7XHJcblxyXG4gIGFic3RyYWN0IERyYXdTb2xpZENpcmNsZShjZW50ZXI6IFhZLCByYWRpdXM6IG51bWJlciwgYXhpczogWFksIGNvbG9yOiBSR0JBKTogdm9pZDtcclxuXHJcbiAgYWJzdHJhY3QgRHJhd1BhcnRpY2xlcyhjZW50ZXJzOiBYWVtdLCByYWRpdXM6IG51bWJlciwgY29sb3JzOiBSR0JBW10gfCBudWxsLCBjb3VudDogbnVtYmVyKTogdm9pZDtcclxuXHJcbiAgYWJzdHJhY3QgRHJhd1NlZ21lbnQocDE6IFhZLCBwMjogWFksIGNvbG9yOiBSR0JBKTogdm9pZDtcclxuXHJcbiAgYWJzdHJhY3QgRHJhd1RyYW5zZm9ybSh4ZjogYjJUcmFuc2Zvcm0pOiB2b2lkO1xyXG5cclxuICBhYnN0cmFjdCBEcmF3UG9pbnQocDogWFksIHNpemU6IG51bWJlciwgY29sb3I6IFJHQkEpOiB2b2lkO1xyXG59XHJcbiJdfQ==