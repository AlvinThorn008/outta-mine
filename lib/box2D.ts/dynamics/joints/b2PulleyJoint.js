/*
 * Copyright (c) 2006-2011 Erin Catto http://www.box2d.org
 *
 * This software is provided 'as-is', without any express or implied
 * warranty.  In no event will the authors be held liable for any damages
 * arising from the use of this software.
 * Permission is granted to anyone to use this software for any purpose,
 * including commercial applications, and to alter it and redistribute it
 * freely, subject to the following restrictions:
 * 1. The origin of this software must not be misrepresented; you must not
 * claim that you wrote the original software. If you use this software
 * in a product, an acknowledgment in the product documentation would be
 * appreciated but is not required.
 * 2. Altered source versions must be plainly marked as such, and must not be
 * misrepresented as being the original software.
 * 3. This notice may not be removed or altered from any source distribution.
 */
import { b2_epsilon, b2_linearSlop, b2Assert, b2Maybe } from '../../common/b2Settings';
import { b2Abs, b2Rot, b2Vec2 } from '../../common/b2Math';
import { b2Joint, b2JointDef } from './b2Joint';
export const b2_minPulleyLength = 2;
/// Pulley joint definition. This requires two ground anchors,
/// two dynamic body anchor points, and a pulley ratio.
export class b2PulleyJointDef extends b2JointDef {
    constructor() {
        super(4 /* e_pulleyJoint */);
        this.groundAnchorA = new b2Vec2(-1, 1);
        this.groundAnchorB = new b2Vec2(1, 1);
        this.localAnchorA = new b2Vec2(-1, 0);
        this.localAnchorB = new b2Vec2(1, 0);
        this.lengthA = 0;
        this.lengthB = 0;
        this.ratio = 1;
        this.collideConnected = true;
    }
    Initialize(bA, bB, groundA, groundB, anchorA, anchorB, r) {
        this.bodyA = bA;
        this.bodyB = bB;
        this.groundAnchorA.Copy(groundA);
        this.groundAnchorB.Copy(groundB);
        this.bodyA.GetLocalPoint(anchorA, this.localAnchorA);
        this.bodyB.GetLocalPoint(anchorB, this.localAnchorB);
        this.lengthA = b2Vec2.DistanceVV(anchorA, groundA);
        this.lengthB = b2Vec2.DistanceVV(anchorB, groundB);
        this.ratio = r;
        !!B2_DEBUG && b2Assert(this.ratio > b2_epsilon);
    }
}
export class b2PulleyJoint extends b2Joint {
    constructor(def) {
        super(def);
        this.m_groundAnchorA = new b2Vec2();
        this.m_groundAnchorB = new b2Vec2();
        this.m_lengthA = 0;
        this.m_lengthB = 0;
        // Solver shared
        this.m_localAnchorA = new b2Vec2();
        this.m_localAnchorB = new b2Vec2();
        this.m_constant = 0;
        this.m_ratio = 0;
        this.m_impulse = 0;
        // Solver temp
        this.m_indexA = 0;
        this.m_indexB = 0;
        this.m_uA = new b2Vec2();
        this.m_uB = new b2Vec2();
        this.m_rA = new b2Vec2();
        this.m_rB = new b2Vec2();
        this.m_localCenterA = new b2Vec2();
        this.m_localCenterB = new b2Vec2();
        this.m_invMassA = 0;
        this.m_invMassB = 0;
        this.m_invIA = 0;
        this.m_invIB = 0;
        this.m_mass = 0;
        this.m_qA = new b2Rot();
        this.m_qB = new b2Rot();
        this.m_lalcA = new b2Vec2();
        this.m_lalcB = new b2Vec2();
        this.m_groundAnchorA.Copy(b2Maybe(def.groundAnchorA, new b2Vec2(-1, 1)));
        this.m_groundAnchorB.Copy(b2Maybe(def.groundAnchorB, new b2Vec2(1, 0)));
        this.m_localAnchorA.Copy(b2Maybe(def.localAnchorA, new b2Vec2(-1, 0)));
        this.m_localAnchorB.Copy(b2Maybe(def.localAnchorB, new b2Vec2(1, 0)));
        this.m_lengthA = b2Maybe(def.lengthA, 0);
        this.m_lengthB = b2Maybe(def.lengthB, 0);
        !!B2_DEBUG && b2Assert(b2Maybe(def.ratio, 1) !== 0);
        this.m_ratio = b2Maybe(def.ratio, 1);
        this.m_constant = b2Maybe(def.lengthA, 0) + this.m_ratio * b2Maybe(def.lengthB, 0);
        this.m_impulse = 0;
    }
    InitVelocityConstraints(data) {
        this.m_indexA = this.m_bodyA.m_islandIndex;
        this.m_indexB = this.m_bodyB.m_islandIndex;
        this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);
        this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        const cA = data.positions[this.m_indexA].c;
        const aA = data.positions[this.m_indexA].a;
        const vA = data.velocities[this.m_indexA].v;
        let wA = data.velocities[this.m_indexA].w;
        const cB = data.positions[this.m_indexB].c;
        const aB = data.positions[this.m_indexB].a;
        const vB = data.velocities[this.m_indexB].v;
        let wB = data.velocities[this.m_indexB].w;
        // b2Rot qA(aA), qB(aB);
        const qA = this.m_qA.SetAngle(aA), qB = this.m_qB.SetAngle(aB);
        // m_rA = b2Mul(qA, m_localAnchorA - m_localCenterA);
        b2Vec2.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
        b2Rot.MulRV(qA, this.m_lalcA, this.m_rA);
        // m_rB = b2Mul(qB, m_localAnchorB - m_localCenterB);
        b2Vec2.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
        b2Rot.MulRV(qB, this.m_lalcB, this.m_rB);
        // Get the pulley axes.
        // m_uA = cA + m_rA - m_groundAnchorA;
        this.m_uA.Copy(cA).SelfAdd(this.m_rA).SelfSub(this.m_groundAnchorA);
        // m_uB = cB + m_rB - m_groundAnchorB;
        this.m_uB.Copy(cB).SelfAdd(this.m_rB).SelfSub(this.m_groundAnchorB);
        const lengthA = this.m_uA.Length();
        const lengthB = this.m_uB.Length();
        if (lengthA > 10 * b2_linearSlop) {
            this.m_uA.SelfMul(1 / lengthA);
        }
        else {
            this.m_uA.SetZero();
        }
        if (lengthB > 10 * b2_linearSlop) {
            this.m_uB.SelfMul(1 / lengthB);
        }
        else {
            this.m_uB.SetZero();
        }
        // Compute effective mass.
        const ruA = b2Vec2.CrossVV(this.m_rA, this.m_uA);
        const ruB = b2Vec2.CrossVV(this.m_rB, this.m_uB);
        const mA = this.m_invMassA + this.m_invIA * ruA * ruA;
        const mB = this.m_invMassB + this.m_invIB * ruB * ruB;
        this.m_mass = mA + this.m_ratio * this.m_ratio * mB;
        if (this.m_mass > 0) {
            this.m_mass = 1 / this.m_mass;
        }
        if (data.step.warmStarting) {
            // Scale impulses to support variable time steps.
            this.m_impulse *= data.step.dtRatio;
            // Warm starting.
            // b2Vec2 PA = -(m_impulse) * m_uA;
            const PA = b2Vec2.MulSV(-this.m_impulse, this.m_uA, b2PulleyJoint.InitVelocityConstraints_s_PA);
            // b2Vec2 PB = (-m_ratio * m_impulse) * m_uB;
            const PB = b2Vec2.MulSV(-this.m_ratio * this.m_impulse, this.m_uB, b2PulleyJoint.InitVelocityConstraints_s_PB);
            // vA += m_invMassA * PA;
            vA.SelfMulAdd(this.m_invMassA, PA);
            wA += this.m_invIA * b2Vec2.CrossVV(this.m_rA, PA);
            // vB += m_invMassB * PB;
            vB.SelfMulAdd(this.m_invMassB, PB);
            wB += this.m_invIB * b2Vec2.CrossVV(this.m_rB, PB);
        }
        else {
            this.m_impulse = 0;
        }
        // data.velocities[this.m_indexA].v = vA;
        data.velocities[this.m_indexA].w = wA;
        // data.velocities[this.m_indexB].v = vB;
        data.velocities[this.m_indexB].w = wB;
    }
    SolveVelocityConstraints(data) {
        const vA = data.velocities[this.m_indexA].v;
        let wA = data.velocities[this.m_indexA].w;
        const vB = data.velocities[this.m_indexB].v;
        let wB = data.velocities[this.m_indexB].w;
        // b2Vec2 vpA = vA + b2Cross(wA, m_rA);
        const vpA = b2Vec2.AddVCrossSV(vA, wA, this.m_rA, b2PulleyJoint.SolveVelocityConstraints_s_vpA);
        // b2Vec2 vpB = vB + b2Cross(wB, m_rB);
        const vpB = b2Vec2.AddVCrossSV(vB, wB, this.m_rB, b2PulleyJoint.SolveVelocityConstraints_s_vpB);
        const Cdot = -b2Vec2.DotVV(this.m_uA, vpA) - this.m_ratio * b2Vec2.DotVV(this.m_uB, vpB);
        const impulse = -this.m_mass * Cdot;
        this.m_impulse += impulse;
        // b2Vec2 PA = -impulse * m_uA;
        const PA = b2Vec2.MulSV(-impulse, this.m_uA, b2PulleyJoint.SolveVelocityConstraints_s_PA);
        // b2Vec2 PB = -m_ratio * impulse * m_uB;
        const PB = b2Vec2.MulSV(-this.m_ratio * impulse, this.m_uB, b2PulleyJoint.SolveVelocityConstraints_s_PB);
        // vA += m_invMassA * PA;
        vA.SelfMulAdd(this.m_invMassA, PA);
        wA += this.m_invIA * b2Vec2.CrossVV(this.m_rA, PA);
        // vB += m_invMassB * PB;
        vB.SelfMulAdd(this.m_invMassB, PB);
        wB += this.m_invIB * b2Vec2.CrossVV(this.m_rB, PB);
        // data.velocities[this.m_indexA].v = vA;
        data.velocities[this.m_indexA].w = wA;
        // data.velocities[this.m_indexB].v = vB;
        data.velocities[this.m_indexB].w = wB;
    }
    SolvePositionConstraints(data) {
        const cA = data.positions[this.m_indexA].c;
        let aA = data.positions[this.m_indexA].a;
        const cB = data.positions[this.m_indexB].c;
        let aB = data.positions[this.m_indexB].a;
        // b2Rot qA(aA), qB(aB);
        const qA = this.m_qA.SetAngle(aA), qB = this.m_qB.SetAngle(aB);
        // b2Vec2 rA = b2Mul(qA, m_localAnchorA - m_localCenterA);
        b2Vec2.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
        const rA = b2Rot.MulRV(qA, this.m_lalcA, this.m_rA);
        // b2Vec2 rB = b2Mul(qB, m_localAnchorB - m_localCenterB);
        b2Vec2.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
        const rB = b2Rot.MulRV(qB, this.m_lalcB, this.m_rB);
        // Get the pulley axes.
        // b2Vec2 uA = cA + rA - m_groundAnchorA;
        const uA = this.m_uA.Copy(cA).SelfAdd(rA).SelfSub(this.m_groundAnchorA);
        // b2Vec2 uB = cB + rB - m_groundAnchorB;
        const uB = this.m_uB.Copy(cB).SelfAdd(rB).SelfSub(this.m_groundAnchorB);
        const lengthA = uA.Length();
        const lengthB = uB.Length();
        if (lengthA > 10 * b2_linearSlop) {
            uA.SelfMul(1 / lengthA);
        }
        else {
            uA.SetZero();
        }
        if (lengthB > 10 * b2_linearSlop) {
            uB.SelfMul(1 / lengthB);
        }
        else {
            uB.SetZero();
        }
        // Compute effective mass.
        const ruA = b2Vec2.CrossVV(rA, uA);
        const ruB = b2Vec2.CrossVV(rB, uB);
        const mA = this.m_invMassA + this.m_invIA * ruA * ruA;
        const mB = this.m_invMassB + this.m_invIB * ruB * ruB;
        let mass = mA + this.m_ratio * this.m_ratio * mB;
        if (mass > 0) {
            mass = 1 / mass;
        }
        const C = this.m_constant - lengthA - this.m_ratio * lengthB;
        const linearError = b2Abs(C);
        const impulse = -mass * C;
        // b2Vec2 PA = -impulse * uA;
        const PA = b2Vec2.MulSV(-impulse, uA, b2PulleyJoint.SolvePositionConstraints_s_PA);
        // b2Vec2 PB = -m_ratio * impulse * uB;
        const PB = b2Vec2.MulSV(-this.m_ratio * impulse, uB, b2PulleyJoint.SolvePositionConstraints_s_PB);
        // cA += m_invMassA * PA;
        cA.SelfMulAdd(this.m_invMassA, PA);
        aA += this.m_invIA * b2Vec2.CrossVV(rA, PA);
        // cB += m_invMassB * PB;
        cB.SelfMulAdd(this.m_invMassB, PB);
        aB += this.m_invIB * b2Vec2.CrossVV(rB, PB);
        // data.positions[this.m_indexA].c = cA;
        data.positions[this.m_indexA].a = aA;
        // data.positions[this.m_indexB].c = cB;
        data.positions[this.m_indexB].a = aB;
        return linearError < b2_linearSlop;
    }
    GetAnchorA(out) {
        return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, out);
    }
    GetAnchorB(out) {
        return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, out);
    }
    GetReactionForce(inv_dt, out) {
        // b2Vec2 P = m_impulse * m_uB;
        // return inv_dt * P;
        out.x = inv_dt * this.m_impulse * this.m_uB.x;
        out.y = inv_dt * this.m_impulse * this.m_uB.y;
        return out;
    }
    GetReactionTorque(inv_dt) {
        return 0;
    }
    GetGroundAnchorA() {
        return this.m_groundAnchorA;
    }
    GetGroundAnchorB() {
        return this.m_groundAnchorB;
    }
    GetLengthA() {
        return this.m_lengthA;
    }
    GetLengthB() {
        return this.m_lengthB;
    }
    GetRatio() {
        return this.m_ratio;
    }
    GetCurrentLengthA() {
        // b2Vec2 p = m_bodyA->GetWorldPoint(m_localAnchorA);
        // b2Vec2 s = m_groundAnchorA;
        // b2Vec2 d = p - s;
        // return d.Length();
        const p = this.m_bodyA.GetWorldPoint(this.m_localAnchorA, b2PulleyJoint.GetCurrentLengthA_s_p);
        const s = this.m_groundAnchorA;
        return b2Vec2.DistanceVV(p, s);
    }
    GetCurrentLengthB() {
        // b2Vec2 p = m_bodyB->GetWorldPoint(m_localAnchorB);
        // b2Vec2 s = m_groundAnchorB;
        // b2Vec2 d = p - s;
        // return d.Length();
        const p = this.m_bodyB.GetWorldPoint(this.m_localAnchorB, b2PulleyJoint.GetCurrentLengthB_s_p);
        const s = this.m_groundAnchorB;
        return b2Vec2.DistanceVV(p, s);
    }
    ShiftOrigin(newOrigin) {
        this.m_groundAnchorA.SelfSub(newOrigin);
        this.m_groundAnchorB.SelfSub(newOrigin);
    }
}
b2PulleyJoint.InitVelocityConstraints_s_PA = new b2Vec2();
b2PulleyJoint.InitVelocityConstraints_s_PB = new b2Vec2();
b2PulleyJoint.SolveVelocityConstraints_s_vpA = new b2Vec2();
b2PulleyJoint.SolveVelocityConstraints_s_vpB = new b2Vec2();
b2PulleyJoint.SolveVelocityConstraints_s_PA = new b2Vec2();
b2PulleyJoint.SolveVelocityConstraints_s_PB = new b2Vec2();
b2PulleyJoint.SolvePositionConstraints_s_PA = new b2Vec2();
b2PulleyJoint.SolvePositionConstraints_s_PB = new b2Vec2();
b2PulleyJoint.GetCurrentLengthA_s_p = new b2Vec2();
b2PulleyJoint.GetCurrentLengthB_s_p = new b2Vec2();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYjJQdWxsZXlKb2ludC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9keW5hbWljcy9qb2ludHMvYjJQdWxsZXlKb2ludC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7OztHQWdCRztBQUVILE9BQU8sRUFBRSxVQUFVLEVBQUUsYUFBYSxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUN2RixPQUFPLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQU0sTUFBTSxxQkFBcUIsQ0FBQztBQUUvRCxPQUFPLEVBQWUsT0FBTyxFQUFFLFVBQVUsRUFBZSxNQUFNLFdBQVcsQ0FBQztBQUcxRSxNQUFNLENBQUMsTUFBTSxrQkFBa0IsR0FBRyxDQUFDLENBQUM7QUFrQnBDLDhEQUE4RDtBQUM5RCx1REFBdUQ7QUFDdkQsTUFBTSxPQUFPLGdCQUFpQixTQUFRLFVBQVU7SUFlOUM7UUFDRSxLQUFLLHVCQUEyQixDQUFDO1FBZjFCLGtCQUFhLEdBQVcsSUFBSSxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFFMUMsa0JBQWEsR0FBVyxJQUFJLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFFekMsaUJBQVksR0FBVyxJQUFJLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUV6QyxpQkFBWSxHQUFXLElBQUksTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUVqRCxZQUFPLEdBQUcsQ0FBQyxDQUFDO1FBRVosWUFBTyxHQUFHLENBQUMsQ0FBQztRQUVaLFVBQUssR0FBRyxDQUFDLENBQUM7UUFJUixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDO0lBQy9CLENBQUM7SUFFRCxVQUFVLENBQ1IsRUFBVSxFQUNWLEVBQVUsRUFDVixPQUFlLEVBQ2YsT0FBZSxFQUNm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LEVBQUUsQ0FBQztBQVlyQyxtQ0FBcUIsR0FBRyxJQUFJLE1BQU0sRUFBRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogQ29weXJpZ2h0IChjKSAyMDA2LTIwMTEgRXJpbiBDYXR0byBodHRwOi8vd3d3LmJveDJkLm9yZ1xyXG4gKlxyXG4gKiBUaGlzIHNvZnR3YXJlIGlzIHByb3ZpZGVkICdhcy1pcycsIHdpdGhvdXQgYW55IGV4cHJlc3Mgb3IgaW1wbGllZFxyXG4gKiB3YXJyYW50eS4gIEluIG5vIGV2ZW50IHdpbGwgdGhlIGF1dGhvcnMgYmUgaGVsZCBsaWFibGUgZm9yIGFueSBkYW1hZ2VzXHJcbiAqIGFyaXNpbmcgZnJvbSB0aGUgdXNlIG9mIHRoaXMgc29mdHdhcmUuXHJcbiAqIFBlcm1pc3Npb24gaXMgZ3JhbnRlZCB0byBhbnlvbmUgdG8gdXNlIHRoaXMgc29mdHdhcmUgZm9yIGFueSBwdXJwb3NlLFxyXG4gKiBpbmNsdWRpbmcgY29tbWVyY2lhbCBhcHBsaWNhdGlvbnMsIGFuZCB0byBhbHRlciBpdCBhbmQgcmVkaXN0cmlidXRlIGl0XHJcbiAqIGZyZWVseSwgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIHJlc3RyaWN0aW9uczpcclxuICogMS4gVGhlIG9yaWdpbiBvZiB0aGlzIHNvZnR3YXJlIG11c3Qgbm90IGJlIG1pc3JlcHJlc2VudGVkOyB5b3UgbXVzdCBub3RcclxuICogY2xhaW0gdGhhdCB5b3Ugd3JvdGUgdGhlIG9yaWdpbmFsIHNvZnR3YXJlLiBJZiB5b3UgdXNlIHRoaXMgc29mdHdhcmVcclxuICogaW4gYSBwcm9kdWN0LCBhbiBhY2tub3dsZWRnbWVudCBpbiB0aGUgcHJvZHVjdCBkb2N1bWVudGF0aW9uIHdvdWxkIGJlXHJcbiAqIGFwcHJlY2lhdGVkIGJ1dCBpcyBub3QgcmVxdWlyZWQuXHJcbiAqIDIuIEFsdGVyZWQgc291cmNlIHZlcnNpb25zIG11c3QgYmUgcGxhaW5seSBtYXJrZWQgYXMgc3VjaCwgYW5kIG11c3Qgbm90IGJlXHJcbiAqIG1pc3JlcHJlc2VudGVkIGFzIGJlaW5nIHRoZSBvcmlnaW5hbCBzb2Z0d2FyZS5cclxuICogMy4gVGhpcyBub3RpY2UgbWF5IG5vdCBiZSByZW1vdmVkIG9yIGFsdGVyZWQgZnJvbSBhbnkgc291cmNlIGRpc3RyaWJ1dGlvbi5cclxuICovXHJcblxyXG5pbXBvcnQgeyBiMl9lcHNpbG9uLCBiMl9saW5lYXJTbG9wLCBiMkFzc2VydCwgYjJNYXliZSB9IGZyb20gJy4uLy4uL2NvbW1vbi9iMlNldHRpbmdzJztcclxuaW1wb3J0IHsgYjJBYnMsIGIyUm90LCBiMlZlYzIsIFhZIH0gZnJvbSAnLi4vLi4vY29tbW9uL2IyTWF0aCc7XHJcbmltcG9ydCB7IGIyQm9keSB9IGZyb20gJy4uL2IyQm9keSc7XHJcbmltcG9ydCB7IGIySUpvaW50RGVmLCBiMkpvaW50LCBiMkpvaW50RGVmLCBiMkpvaW50VHlwZSB9IGZyb20gJy4vYjJKb2ludCc7XHJcbmltcG9ydCB7IGIyU29sdmVyRGF0YSB9IGZyb20gJy4uL2IyVGltZVN0ZXAnO1xyXG5cclxuZXhwb3J0IGNvbnN0IGIyX21pblB1bGxleUxlbmd0aCA9IDI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIGIySVB1bGxleUpvaW50RGVmIGV4dGVuZHMgYjJJSm9pbnREZWYge1xyXG4gIGdyb3VuZEFuY2hvckE/OiBYWTtcclxuXHJcbiAgZ3JvdW5kQW5jaG9yQj86IFhZO1xyXG5cclxuICBsb2NhbEFuY2hvckE/OiBYWTtcclxuXHJcbiAgbG9jYWxBbmNob3JCPzogWFk7XHJcblxyXG4gIGxlbmd0aEE/OiBudW1iZXI7XHJcblxyXG4gIGxlbmd0aEI/OiBudW1iZXI7XHJcblxyXG4gIHJhdGlvPzogbnVtYmVyO1xyXG59XHJcblxyXG4vLy8gUHVsbGV5IGpvaW50IGRlZmluaXRpb24uIFRoaXMgcmVxdWlyZXMgdHdvIGdyb3VuZCBhbmNob3JzLFxyXG4vLy8gdHdvIGR5bmFtaWMgYm9keSBhbmNob3IgcG9pbnRzLCBhbmQgYSBwdWxsZXkgcmF0aW8uXHJcbmV4cG9ydCBjbGFzcyBiMlB1bGxleUpvaW50RGVmIGV4dGVuZHMgYjJKb2ludERlZiBpbXBsZW1lbnRzIGIySVB1bGxleUpvaW50RGVmIHtcclxuICByZWFkb25seSBncm91bmRBbmNob3JBOiBiMlZlYzIgPSBuZXcgYjJWZWMyKC0xLCAxKTtcclxuXHJcbiAgcmVhZG9ubHkgZ3JvdW5kQW5jaG9yQjogYjJWZWMyID0gbmV3IGIyVmVjMigxLCAxKTtcclxuXHJcbiAgcmVhZG9ubHkgbG9jYWxBbmNob3JBOiBiMlZlYzIgPSBuZXcgYjJWZWMyKC0xLCAwKTtcclxuXHJcbiAgcmVhZG9ubHkgbG9jYWxBbmNob3JCOiBiMlZlYzIgPSBuZXcgYjJWZWMyKDEsIDApO1xyXG5cclxuICBsZW5ndGhBID0gMDtcclxuXHJcbiAgbGVuZ3RoQiA9IDA7XHJcblxyXG4gIHJhdGlvID0gMTtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICBzdXBlcihiMkpvaW50VHlwZS5lX3B1bGxleUpvaW50KTtcclxuICAgIHRoaXMuY29sbGlkZUNvbm5lY3RlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBJbml0aWFsaXplKFxyXG4gICAgYkE6IGIyQm9keSxcclxuICAgIGJCOiBiMkJvZHksXHJcbiAgICBncm91bmRBOiBiMlZlYzIsXHJcbiAgICBncm91bmRCOiBiMlZlYzIsXHJcbiAgICBhbmNob3JBOiBiMlZlYzIsXHJcbiAgICBhbmNob3JCOiBiMlZlYzIsXHJcbiAgICByOiBudW1iZXIsXHJcbiAgKTogdm9pZCB7XHJcbiAgICB0aGlzLmJvZHlBID0gYkE7XHJcbiAgICB0aGlzLmJvZHlCID0gYkI7XHJcbiAgICB0aGlzLmdyb3VuZEFuY2hvckEuQ29weShncm91bmRBKTtcclxuICAgIHRoaXMuZ3JvdW5kQW5jaG9yQi5Db3B5KGdyb3VuZEIpO1xyXG4gICAgdGhpcy5ib2R5QS5HZXRMb2NhbFBvaW50KGFuY2hvckEsIHRoaXMubG9jYWxBbmNob3JBKTtcclxuICAgIHRoaXMuYm9keUIuR2V0TG9jYWxQb2ludChhbmNob3JCLCB0aGlzLmxvY2FsQW5jaG9yQik7XHJcbiAgICB0aGlzLmxlbmd0aEEgPSBiMlZlYzIuRGlzdGFuY2VWVihhbmNob3JBLCBncm91bmRBKTtcclxuICAgIHRoaXMubGVuZ3RoQiA9IGIyVmVjMi5EaXN0YW5jZVZWKGFuY2hvckIsIGdyb3VuZEIpO1xyXG4gICAgdGhpcy5yYXRpbyA9IHI7XHJcbiAgICAhIUIyX0RFQlVHICYmIGIyQXNzZXJ0KHRoaXMucmF0aW8gPiBiMl9lcHNpbG9uKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBiMlB1bGxleUpvaW50IGV4dGVuZHMgYjJKb2ludCB7XHJcbiAgcmVhZG9ubHkgbV9ncm91bmRBbmNob3JBOiBiMlZlYzIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgcmVhZG9ubHkgbV9ncm91bmRBbmNob3JCOiBiMlZlYzIgPSBuZXcgYjJWZWMyKCk7XHJcblxyXG4gIG1fbGVuZ3RoQSA9IDA7XHJcbiAgbV9sZW5ndGhCID0gMDtcclxuXHJcbiAgLy8gU29sdmVyIHNoYXJlZFxyXG4gIHJlYWRvbmx5IG1fbG9jYWxBbmNob3JBOiBiMlZlYzIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgcmVhZG9ubHkgbV9sb2NhbEFuY2hvckI6IGIyVmVjMiA9IG5ldyBiMlZlYzIoKTtcclxuXHJcbiAgbV9jb25zdGFudCA9IDA7XHJcbiAgbV9yYXRpbyA9IDA7XHJcbiAgbV9pbXB1bHNlID0gMDtcclxuXHJcbiAgLy8gU29sdmVyIHRlbXBcclxuICBtX2luZGV4QSA9IDA7XHJcbiAgbV9pbmRleEIgPSAwO1xyXG4gIHJlYWRvbmx5IG1fdUE6IGIyVmVjMiA9IG5ldyBiMlZlYzIoKTtcclxuICByZWFkb25seSBtX3VCOiBiMlZlYzIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgcmVhZG9ubHkgbV9yQTogYjJWZWMyID0gbmV3IGIyVmVjMigpO1xyXG4gIHJlYWRvbmx5IG1fckI6IGIyVmVjMiA9IG5ldyBiMlZlYzIoKTtcclxuICByZWFkb25seSBtX2xvY2FsQ2VudGVyQTogYjJWZWMyID0gbmV3IGIyVmVjMigpO1xyXG4gIHJlYWRvbmx5IG1fbG9jYWxDZW50ZXJCOiBiMlZlYzIgPSBuZXcgYjJWZWMyKCk7XHJcblxyXG4gIG1faW52TWFzc0EgPSAwO1xyXG4gIG1faW52TWFzc0IgPSAwO1xyXG4gIG1faW52SUEgPSAwO1xyXG4gIG1faW52SUIgPSAwO1xyXG4gIG1fbWFzcyA9IDA7XHJcblxyXG4gIHJlYWRvbmx5IG1fcUE6IGIyUm90ID0gbmV3IGIyUm90KCk7XHJcbiAgcmVhZG9ubHkgbV9xQjogYjJSb3QgPSBuZXcgYjJSb3QoKTtcclxuICByZWFkb25seSBtX2xhbGNBOiBiMlZlYzIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgcmVhZG9ubHkgbV9sYWxjQjogYjJWZWMyID0gbmV3IGIyVmVjMigpO1xyXG5cclxuICBjb25zdHJ1Y3RvcihkZWY6IGIySVB1bGxleUpvaW50RGVmKSB7XHJcbiAgICBzdXBlcihkZWYpO1xyXG5cclxuICAgIHRoaXMubV9ncm91bmRBbmNob3JBLkNvcHkoYjJNYXliZShkZWYuZ3JvdW5kQW5jaG9yQSwgbmV3IGIyVmVjMigtMSwgMSkpKTtcclxuICAgIHRoaXMubV9ncm91bmRBbmNob3JCLkNvcHkoYjJNYXliZShkZWYuZ3JvdW5kQW5jaG9yQiwgbmV3IGIyVmVjMigxLCAwKSkpO1xyXG4gICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5Db3B5KGIyTWF5YmUoZGVmLmxvY2FsQW5jaG9yQSwgbmV3IGIyVmVjMigtMSwgMCkpKTtcclxuICAgIHRoaXMubV9sb2NhbEFuY2hvckIuQ29weShiMk1heWJlKGRlZi5sb2NhbEFuY2hvckIsIG5ldyBiMlZlYzIoMSwgMCkpKTtcclxuXHJcbiAgICB0aGlzLm1fbGVuZ3RoQSA9IGIyTWF5YmUoZGVmLmxlbmd0aEEsIDApO1xyXG4gICAgdGhpcy5tX2xlbmd0aEIgPSBiMk1heWJlKGRlZi5sZW5ndGhCLCAwKTtcclxuXHJcbiAgICAhIUIyX0RFQlVHICYmIGIyQXNzZXJ0KGIyTWF5YmUoZGVmLnJhdGlvLCAxKSAhPT0gMCk7XHJcbiAgICB0aGlzLm1fcmF0aW8gPSBiMk1heWJlKGRlZi5yYXRpbywgMSk7XHJcblxyXG4gICAgdGhpcy5tX2NvbnN0YW50ID0gYjJNYXliZShkZWYubGVuZ3RoQSwgMCkgKyB0aGlzLm1fcmF0aW8gKiBiMk1heWJlKGRlZi5sZW5ndGhCLCAwKTtcclxuXHJcbiAgICB0aGlzLm1faW1wdWxzZSA9IDA7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHN0YXRpYyBJbml0VmVsb2NpdHlDb25zdHJhaW50c19zX1BBID0gbmV3IGIyVmVjMigpO1xyXG4gIHByaXZhdGUgc3RhdGljIEluaXRWZWxvY2l0eUNvbnN0cmFpbnRzX3NfUEIgPSBuZXcgYjJWZWMyKCk7XHJcblxyXG4gIEluaXRWZWxvY2l0eUNvbnN0cmFpbnRzKGRhdGE6IGIyU29sdmVyRGF0YSk6IHZvaWQge1xyXG4gICAgdGhpcy5tX2luZGV4QSA9IHRoaXMubV9ib2R5QS5tX2lzbGFuZEluZGV4O1xyXG4gICAgdGhpcy5tX2luZGV4QiA9IHRoaXMubV9ib2R5Qi5tX2lzbGFuZEluZGV4O1xyXG4gICAgdGhpcy5tX2xvY2FsQ2VudGVyQS5Db3B5KHRoaXMubV9ib2R5QS5tX3N3ZWVwLmxvY2FsQ2VudGVyKTtcclxuICAgIHRoaXMubV9sb2NhbENlbnRlckIuQ29weSh0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcik7XHJcbiAgICB0aGlzLm1faW52TWFzc0EgPSB0aGlzLm1fYm9keUEubV9pbnZNYXNzO1xyXG4gICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcclxuICAgIHRoaXMubV9pbnZJQSA9IHRoaXMubV9ib2R5QS5tX2ludkk7XHJcbiAgICB0aGlzLm1faW52SUIgPSB0aGlzLm1fYm9keUIubV9pbnZJO1xyXG5cclxuICAgIGNvbnN0IGNBOiBiMlZlYzIgPSBkYXRhLnBvc2l0aW9uc1t0aGlzLm1faW5kZXhBXS5jO1xyXG4gICAgY29uc3QgYUE6IG51bWJlciA9IGRhdGEucG9zaXRpb25zW3RoaXMubV9pbmRleEFdLmE7XHJcbiAgICBjb25zdCB2QTogYjJWZWMyID0gZGF0YS52ZWxvY2l0aWVzW3RoaXMubV9pbmRleEFdLnY7XHJcbiAgICBsZXQgd0E6IG51bWJlciA9IGRhdGEudmVsb2NpdGllc1t0aGlzLm1faW5kZXhBXS53O1xyXG5cclxuICAgIGNvbnN0IGNCOiBiMlZlYzIgPSBkYXRhLnBvc2l0aW9uc1t0aGlzLm1faW5kZXhCXS5jO1xyXG4gICAgY29uc3QgYUI6IG51bWJlciA9IGRhdGEucG9zaXRpb25zW3RoaXMubV9pbmRleEJdLmE7XHJcbiAgICBjb25zdCB2QjogYjJWZWMyID0gZGF0YS52ZWxvY2l0aWVzW3RoaXMubV9pbmRleEJdLnY7XHJcbiAgICBsZXQgd0I6IG51bWJlciA9IGRhdGEudmVsb2NpdGllc1t0aGlzLm1faW5kZXhCXS53O1xyXG5cclxuICAgIC8vIGIyUm90IHFBKGFBKSwgcUIoYUIpO1xyXG4gICAgY29uc3QgcUE6IGIyUm90ID0gdGhpcy5tX3FBLlNldEFuZ2xlKGFBKSxcclxuICAgICAgcUI6IGIyUm90ID0gdGhpcy5tX3FCLlNldEFuZ2xlKGFCKTtcclxuXHJcbiAgICAvLyBtX3JBID0gYjJNdWwocUEsIG1fbG9jYWxBbmNob3JBIC0gbV9sb2NhbENlbnRlckEpO1xyXG4gICAgYjJWZWMyLlN1YlZWKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEsIHRoaXMubV9sYWxjQSk7XHJcbiAgICBiMlJvdC5NdWxSVihxQSwgdGhpcy5tX2xhbGNBLCB0aGlzLm1fckEpO1xyXG4gICAgLy8gbV9yQiA9IGIyTXVsKHFCLCBtX2xvY2FsQW5jaG9yQiAtIG1fbG9jYWxDZW50ZXJCKTtcclxuICAgIGIyVmVjMi5TdWJWVih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCLCB0aGlzLm1fbGFsY0IpO1xyXG4gICAgYjJSb3QuTXVsUlYocUIsIHRoaXMubV9sYWxjQiwgdGhpcy5tX3JCKTtcclxuXHJcbiAgICAvLyBHZXQgdGhlIHB1bGxleSBheGVzLlxyXG4gICAgLy8gbV91QSA9IGNBICsgbV9yQSAtIG1fZ3JvdW5kQW5jaG9yQTtcclxuICAgIHRoaXMubV91QS5Db3B5KGNBKS5TZWxmQWRkKHRoaXMubV9yQSkuU2VsZlN1Yih0aGlzLm1fZ3JvdW5kQW5jaG9yQSk7XHJcbiAgICAvLyBtX3VCID0gY0IgKyBtX3JCIC0gbV9ncm91bmRBbmNob3JCO1xyXG4gICAgdGhpcy5tX3VCLkNvcHkoY0IpLlNlbGZBZGQodGhpcy5tX3JCKS5TZWxmU3ViKHRoaXMubV9ncm91bmRBbmNob3JCKTtcclxuXHJcbiAgICBjb25zdCBsZW5ndGhBOiBudW1iZXIgPSB0aGlzLm1fdUEuTGVuZ3RoKCk7XHJcbiAgICBjb25zdCBsZW5ndGhCOiBudW1iZXIgPSB0aGlzLm1fdUIuTGVuZ3RoKCk7XHJcblxyXG4gICAgaWYgKGxlbmd0aEEgPiAxMCAqIGIyX2xpbmVhclNsb3ApIHtcclxuICAgICAgdGhpcy5tX3VBLlNlbGZNdWwoMSAvIGxlbmd0aEEpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5tX3VBLlNldFplcm8oKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAobGVuZ3RoQiA+IDEwICogYjJfbGluZWFyU2xvcCkge1xyXG4gICAgICB0aGlzLm1fdUIuU2VsZk11bCgxIC8gbGVuZ3RoQik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLm1fdUIuU2V0WmVybygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENvbXB1dGUgZWZmZWN0aXZlIG1hc3MuXHJcbiAgICBjb25zdCBydUE6IG51bWJlciA9IGIyVmVjMi5Dcm9zc1ZWKHRoaXMubV9yQSwgdGhpcy5tX3VBKTtcclxuICAgIGNvbnN0IHJ1QjogbnVtYmVyID0gYjJWZWMyLkNyb3NzVlYodGhpcy5tX3JCLCB0aGlzLm1fdUIpO1xyXG5cclxuICAgIGNvbnN0IG1BOiBudW1iZXIgPSB0aGlzLm1faW52TWFzc0EgKyB0aGlzLm1faW52SUEgKiBydUEgKiBydUE7XHJcbiAgICBjb25zdCBtQjogbnVtYmVyID0gdGhpcy5tX2ludk1hc3NCICsgdGhpcy5tX2ludklCICogcnVCICogcnVCO1xyXG5cclxuICAgIHRoaXMubV9tYXNzID0gbUEgKyB0aGlzLm1fcmF0aW8gKiB0aGlzLm1fcmF0aW8gKiBtQjtcclxuXHJcbiAgICBpZiAodGhpcy5tX21hc3MgPiAwKSB7XHJcbiAgICAgIHRoaXMubV9tYXNzID0gMSAvIHRoaXMubV9tYXNzO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChkYXRhLnN0ZXAud2FybVN0YXJ0aW5nKSB7XHJcbiAgICAgIC8vIFNjYWxlIGltcHVsc2VzIHRvIHN1cHBvcnQgdmFyaWFibGUgdGltZSBzdGVwcy5cclxuICAgICAgdGhpcy5tX2ltcHVsc2UgKj0gZGF0YS5zdGVwLmR0UmF0aW87XHJcblxyXG4gICAgICAvLyBXYXJtIHN0YXJ0aW5nLlxyXG4gICAgICAvLyBiMlZlYzIgUEEgPSAtKG1faW1wdWxzZSkgKiBtX3VBO1xyXG4gICAgICBjb25zdCBQQTogYjJWZWMyID0gYjJWZWMyLk11bFNWKFxyXG4gICAgICAgIC10aGlzLm1faW1wdWxzZSxcclxuICAgICAgICB0aGlzLm1fdUEsXHJcbiAgICAgICAgYjJQdWxsZXlKb2ludC5Jbml0VmVsb2NpdHlDb25zdHJhaW50c19zX1BBLFxyXG4gICAgICApO1xyXG4gICAgICAvLyBiMlZlYzIgUEIgPSAoLW1fcmF0aW8gKiBtX2ltcHVsc2UpICogbV91QjtcclxuICAgICAgY29uc3QgUEI6IGIyVmVjMiA9IGIyVmVjMi5NdWxTVihcclxuICAgICAgICAtdGhpcy5tX3JhdGlvICogdGhpcy5tX2ltcHVsc2UsXHJcbiAgICAgICAgdGhpcy5tX3VCLFxyXG4gICAgICAgIGIyUHVsbGV5Sm9pbnQuSW5pdFZlbG9jaXR5Q29uc3RyYWludHNfc19QQixcclxuICAgICAgKTtcclxuXHJcbiAgICAgIC8vIHZBICs9IG1faW52TWFzc0EgKiBQQTtcclxuICAgICAgdkEuU2VsZk11bEFkZCh0aGlzLm1faW52TWFzc0EsIFBBKTtcclxuICAgICAgd0EgKz0gdGhpcy5tX2ludklBICogYjJWZWMyLkNyb3NzVlYodGhpcy5tX3JBLCBQQSk7XHJcbiAgICAgIC8vIHZCICs9IG1faW52TWFzc0IgKiBQQjtcclxuICAgICAgdkIuU2VsZk11bEFkZCh0aGlzLm1faW52TWFzc0IsIFBCKTtcclxuICAgICAgd0IgKz0gdGhpcy5tX2ludklCICogYjJWZWMyLkNyb3NzVlYodGhpcy5tX3JCLCBQQik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLm1faW1wdWxzZSA9IDA7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gZGF0YS52ZWxvY2l0aWVzW3RoaXMubV9pbmRleEFdLnYgPSB2QTtcclxuICAgIGRhdGEudmVsb2NpdGllc1t0aGlzLm1faW5kZXhBXS53ID0gd0E7XHJcbiAgICAvLyBkYXRhLnZlbG9jaXRpZXNbdGhpcy5tX2luZGV4Ql0udiA9IHZCO1xyXG4gICAgZGF0YS52ZWxvY2l0aWVzW3RoaXMubV9pbmRleEJdLncgPSB3QjtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIFNvbHZlVmVsb2NpdHlDb25zdHJhaW50c19zX3ZwQSA9IG5ldyBiMlZlYzIoKTtcclxuICBwcml2YXRlIHN0YXRpYyBTb2x2ZVZlbG9jaXR5Q29uc3RyYWludHNfc192cEIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgcHJpdmF0ZSBzdGF0aWMgU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzX3NfUEEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgcHJpdmF0ZSBzdGF0aWMgU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzX3NfUEIgPSBuZXcgYjJWZWMyKCk7XHJcblxyXG4gIFNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyhkYXRhOiBiMlNvbHZlckRhdGEpOiB2b2lkIHtcclxuICAgIGNvbnN0IHZBOiBiMlZlYzIgPSBkYXRhLnZlbG9jaXRpZXNbdGhpcy5tX2luZGV4QV0udjtcclxuICAgIGxldCB3QTogbnVtYmVyID0gZGF0YS52ZWxvY2l0aWVzW3RoaXMubV9pbmRleEFdLnc7XHJcbiAgICBjb25zdCB2QjogYjJWZWMyID0gZGF0YS52ZWxvY2l0aWVzW3RoaXMubV9pbmRleEJdLnY7XHJcbiAgICBsZXQgd0I6IG51bWJlciA9IGRhdGEudmVsb2NpdGllc1t0aGlzLm1faW5kZXhCXS53O1xyXG5cclxuICAgIC8vIGIyVmVjMiB2cEEgPSB2QSArIGIyQ3Jvc3Mod0EsIG1fckEpO1xyXG4gICAgY29uc3QgdnBBOiBiMlZlYzIgPSBiMlZlYzIuQWRkVkNyb3NzU1YoXHJcbiAgICAgIHZBLFxyXG4gICAgICB3QSxcclxuICAgICAgdGhpcy5tX3JBLFxyXG4gICAgICBiMlB1bGxleUpvaW50LlNvbHZlVmVsb2NpdHlDb25zdHJhaW50c19zX3ZwQSxcclxuICAgICk7XHJcbiAgICAvLyBiMlZlYzIgdnBCID0gdkIgKyBiMkNyb3NzKHdCLCBtX3JCKTtcclxuICAgIGNvbnN0IHZwQjogYjJWZWMyID0gYjJWZWMyLkFkZFZDcm9zc1NWKFxyXG4gICAgICB2QixcclxuICAgICAgd0IsXHJcbiAgICAgIHRoaXMubV9yQixcclxuICAgICAgYjJQdWxsZXlKb2ludC5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHNfc192cEIsXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IENkb3Q6IG51bWJlciA9XHJcbiAgICAgIC1iMlZlYzIuRG90VlYodGhpcy5tX3VBLCB2cEEpIC0gdGhpcy5tX3JhdGlvICogYjJWZWMyLkRvdFZWKHRoaXMubV91QiwgdnBCKTtcclxuICAgIGNvbnN0IGltcHVsc2U6IG51bWJlciA9IC10aGlzLm1fbWFzcyAqIENkb3Q7XHJcbiAgICB0aGlzLm1faW1wdWxzZSArPSBpbXB1bHNlO1xyXG5cclxuICAgIC8vIGIyVmVjMiBQQSA9IC1pbXB1bHNlICogbV91QTtcclxuICAgIGNvbnN0IFBBOiBiMlZlYzIgPSBiMlZlYzIuTXVsU1YoXHJcbiAgICAgIC1pbXB1bHNlLFxyXG4gICAgICB0aGlzLm1fdUEsXHJcbiAgICAgIGIyUHVsbGV5Sm9pbnQuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzX3NfUEEsXHJcbiAgICApO1xyXG4gICAgLy8gYjJWZWMyIFBCID0gLW1fcmF0aW8gKiBpbXB1bHNlICogbV91QjtcclxuICAgIGNvbnN0IFBCOiBiMlZlYzIgPSBiMlZlYzIuTXVsU1YoXHJcbiAgICAgIC10aGlzLm1fcmF0aW8gKiBpbXB1bHNlLFxyXG4gICAgICB0aGlzLm1fdUIsXHJcbiAgICAgIGIyUHVsbGV5Sm9pbnQuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzX3NfUEIsXHJcbiAgICApO1xyXG4gICAgLy8gdkEgKz0gbV9pbnZNYXNzQSAqIFBBO1xyXG4gICAgdkEuU2VsZk11bEFkZCh0aGlzLm1faW52TWFzc0EsIFBBKTtcclxuICAgIHdBICs9IHRoaXMubV9pbnZJQSAqIGIyVmVjMi5Dcm9zc1ZWKHRoaXMubV9yQSwgUEEpO1xyXG4gICAgLy8gdkIgKz0gbV9pbnZNYXNzQiAqIFBCO1xyXG4gICAgdkIuU2VsZk11bEFkZCh0aGlzLm1faW52TWFzc0IsIFBCKTtcclxuICAgIHdCICs9IHRoaXMubV9pbnZJQiAqIGIyVmVjMi5Dcm9zc1ZWKHRoaXMubV9yQiwgUEIpO1xyXG5cclxuICAgIC8vIGRhdGEudmVsb2NpdGllc1t0aGlzLm1faW5kZXhBXS52ID0gdkE7XHJcbiAgICBkYXRhLnZlbG9jaXRpZXNbdGhpcy5tX2luZGV4QV0udyA9IHdBO1xyXG4gICAgLy8gZGF0YS52ZWxvY2l0aWVzW3RoaXMubV9pbmRleEJdLnYgPSB2QjtcclxuICAgIGRhdGEudmVsb2NpdGllc1t0aGlzLm1faW5kZXhCXS53ID0gd0I7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHN0YXRpYyBTb2x2ZVBvc2l0aW9uQ29uc3RyYWludHNfc19QQSA9IG5ldyBiMlZlYzIoKTtcclxuICBwcml2YXRlIHN0YXRpYyBTb2x2ZVBvc2l0aW9uQ29uc3RyYWludHNfc19QQiA9IG5ldyBiMlZlYzIoKTtcclxuXHJcbiAgU29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzKGRhdGE6IGIyU29sdmVyRGF0YSk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgY0E6IGIyVmVjMiA9IGRhdGEucG9zaXRpb25zW3RoaXMubV9pbmRleEFdLmM7XHJcbiAgICBsZXQgYUE6IG51bWJlciA9IGRhdGEucG9zaXRpb25zW3RoaXMubV9pbmRleEFdLmE7XHJcbiAgICBjb25zdCBjQjogYjJWZWMyID0gZGF0YS5wb3NpdGlvbnNbdGhpcy5tX2luZGV4Ql0uYztcclxuICAgIGxldCBhQjogbnVtYmVyID0gZGF0YS5wb3NpdGlvbnNbdGhpcy5tX2luZGV4Ql0uYTtcclxuXHJcbiAgICAvLyBiMlJvdCBxQShhQSksIHFCKGFCKTtcclxuICAgIGNvbnN0IHFBOiBiMlJvdCA9IHRoaXMubV9xQS5TZXRBbmdsZShhQSksXHJcbiAgICAgIHFCOiBiMlJvdCA9IHRoaXMubV9xQi5TZXRBbmdsZShhQik7XHJcblxyXG4gICAgLy8gYjJWZWMyIHJBID0gYjJNdWwocUEsIG1fbG9jYWxBbmNob3JBIC0gbV9sb2NhbENlbnRlckEpO1xyXG4gICAgYjJWZWMyLlN1YlZWKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEsIHRoaXMubV9sYWxjQSk7XHJcbiAgICBjb25zdCByQTogYjJWZWMyID0gYjJSb3QuTXVsUlYocUEsIHRoaXMubV9sYWxjQSwgdGhpcy5tX3JBKTtcclxuICAgIC8vIGIyVmVjMiByQiA9IGIyTXVsKHFCLCBtX2xvY2FsQW5jaG9yQiAtIG1fbG9jYWxDZW50ZXJCKTtcclxuICAgIGIyVmVjMi5TdWJWVih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCLCB0aGlzLm1fbGFsY0IpO1xyXG4gICAgY29uc3QgckI6IGIyVmVjMiA9IGIyUm90Lk11bFJWKHFCLCB0aGlzLm1fbGFsY0IsIHRoaXMubV9yQik7XHJcblxyXG4gICAgLy8gR2V0IHRoZSBwdWxsZXkgYXhlcy5cclxuICAgIC8vIGIyVmVjMiB1QSA9IGNBICsgckEgLSBtX2dyb3VuZEFuY2hvckE7XHJcbiAgICBjb25zdCB1QSA9IHRoaXMubV91QS5Db3B5KGNBKS5TZWxmQWRkKHJBKS5TZWxmU3ViKHRoaXMubV9ncm91bmRBbmNob3JBKTtcclxuICAgIC8vIGIyVmVjMiB1QiA9IGNCICsgckIgLSBtX2dyb3VuZEFuY2hvckI7XHJcbiAgICBjb25zdCB1QiA9IHRoaXMubV91Qi5Db3B5KGNCKS5TZWxmQWRkKHJCKS5TZWxmU3ViKHRoaXMubV9ncm91bmRBbmNob3JCKTtcclxuXHJcbiAgICBjb25zdCBsZW5ndGhBOiBudW1iZXIgPSB1QS5MZW5ndGgoKTtcclxuICAgIGNvbnN0IGxlbmd0aEI6IG51bWJlciA9IHVCLkxlbmd0aCgpO1xyXG5cclxuICAgIGlmIChsZW5ndGhBID4gMTAgKiBiMl9saW5lYXJTbG9wKSB7XHJcbiAgICAgIHVBLlNlbGZNdWwoMSAvIGxlbmd0aEEpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdUEuU2V0WmVybygpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChsZW5ndGhCID4gMTAgKiBiMl9saW5lYXJTbG9wKSB7XHJcbiAgICAgIHVCLlNlbGZNdWwoMSAvIGxlbmd0aEIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdUIuU2V0WmVybygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENvbXB1dGUgZWZmZWN0aXZlIG1hc3MuXHJcbiAgICBjb25zdCBydUE6IG51bWJlciA9IGIyVmVjMi5Dcm9zc1ZWKHJBLCB1QSk7XHJcbiAgICBjb25zdCBydUI6IG51bWJlciA9IGIyVmVjMi5Dcm9zc1ZWKHJCLCB1Qik7XHJcblxyXG4gICAgY29uc3QgbUE6IG51bWJlciA9IHRoaXMubV9pbnZNYXNzQSArIHRoaXMubV9pbnZJQSAqIHJ1QSAqIHJ1QTtcclxuICAgIGNvbnN0IG1COiBudW1iZXIgPSB0aGlzLm1faW52TWFzc0IgKyB0aGlzLm1faW52SUIgKiBydUIgKiBydUI7XHJcblxyXG4gICAgbGV0IG1hc3M6IG51bWJlciA9IG1BICsgdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogbUI7XHJcblxyXG4gICAgaWYgKG1hc3MgPiAwKSB7XHJcbiAgICAgIG1hc3MgPSAxIC8gbWFzcztcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBDOiBudW1iZXIgPSB0aGlzLm1fY29uc3RhbnQgLSBsZW5ndGhBIC0gdGhpcy5tX3JhdGlvICogbGVuZ3RoQjtcclxuICAgIGNvbnN0IGxpbmVhckVycm9yOiBudW1iZXIgPSBiMkFicyhDKTtcclxuXHJcbiAgICBjb25zdCBpbXB1bHNlOiBudW1iZXIgPSAtbWFzcyAqIEM7XHJcblxyXG4gICAgLy8gYjJWZWMyIFBBID0gLWltcHVsc2UgKiB1QTtcclxuICAgIGNvbnN0IFBBOiBiMlZlYzIgPSBiMlZlYzIuTXVsU1YoLWltcHVsc2UsIHVBLCBiMlB1bGxleUpvaW50LlNvbHZlUG9zaXRpb25Db25zdHJhaW50c19zX1BBKTtcclxuICAgIC8vIGIyVmVjMiBQQiA9IC1tX3JhdGlvICogaW1wdWxzZSAqIHVCO1xyXG4gICAgY29uc3QgUEI6IGIyVmVjMiA9IGIyVmVjMi5NdWxTVihcclxuICAgICAgLXRoaXMubV9yYXRpbyAqIGltcHVsc2UsXHJcbiAgICAgIHVCLFxyXG4gICAgICBiMlB1bGxleUpvaW50LlNvbHZlUG9zaXRpb25Db25zdHJhaW50c19zX1BCLFxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBjQSArPSBtX2ludk1hc3NBICogUEE7XHJcbiAgICBjQS5TZWxmTXVsQWRkKHRoaXMubV9pbnZNYXNzQSwgUEEpO1xyXG4gICAgYUEgKz0gdGhpcy5tX2ludklBICogYjJWZWMyLkNyb3NzVlYockEsIFBBKTtcclxuICAgIC8vIGNCICs9IG1faW52TWFzc0IgKiBQQjtcclxuICAgIGNCLlNlbGZNdWxBZGQodGhpcy5tX2ludk1hc3NCLCBQQik7XHJcbiAgICBhQiArPSB0aGlzLm1faW52SUIgKiBiMlZlYzIuQ3Jvc3NWVihyQiwgUEIpO1xyXG5cclxuICAgIC8vIGRhdGEucG9zaXRpb25zW3RoaXMubV9pbmRleEFdLmMgPSBjQTtcclxuICAgIGRhdGEucG9zaXRpb25zW3RoaXMubV9pbmRleEFdLmEgPSBhQTtcclxuICAgIC8vIGRhdGEucG9zaXRpb25zW3RoaXMubV9pbmRleEJdLmMgPSBjQjtcclxuICAgIGRhdGEucG9zaXRpb25zW3RoaXMubV9pbmRleEJdLmEgPSBhQjtcclxuXHJcbiAgICByZXR1cm4gbGluZWFyRXJyb3IgPCBiMl9saW5lYXJTbG9wO1xyXG4gIH1cclxuXHJcbiAgR2V0QW5jaG9yQTxUIGV4dGVuZHMgWFk+KG91dDogVCk6IFQge1xyXG4gICAgcmV0dXJuIHRoaXMubV9ib2R5QS5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEsIG91dCk7XHJcbiAgfVxyXG5cclxuICBHZXRBbmNob3JCPFQgZXh0ZW5kcyBYWT4ob3V0OiBUKTogVCB7XHJcbiAgICByZXR1cm4gdGhpcy5tX2JvZHlCLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQiwgb3V0KTtcclxuICB9XHJcblxyXG4gIEdldFJlYWN0aW9uRm9yY2U8VCBleHRlbmRzIFhZPihpbnZfZHQ6IG51bWJlciwgb3V0OiBUKTogVCB7XHJcbiAgICAvLyBiMlZlYzIgUCA9IG1faW1wdWxzZSAqIG1fdUI7XHJcbiAgICAvLyByZXR1cm4gaW52X2R0ICogUDtcclxuICAgIG91dC54ID0gaW52X2R0ICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fdUIueDtcclxuICAgIG91dC55ID0gaW52X2R0ICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fdUIueTtcclxuICAgIHJldHVybiBvdXQ7XHJcbiAgfVxyXG5cclxuICBHZXRSZWFjdGlvblRvcnF1ZShpbnZfZHQ6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICByZXR1cm4gMDtcclxuICB9XHJcblxyXG4gIEdldEdyb3VuZEFuY2hvckEoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5tX2dyb3VuZEFuY2hvckE7XHJcbiAgfVxyXG5cclxuICBHZXRHcm91bmRBbmNob3JCKCkge1xyXG4gICAgcmV0dXJuIHRoaXMubV9ncm91bmRBbmNob3JCO1xyXG4gIH1cclxuXHJcbiAgR2V0TGVuZ3RoQSgpIHtcclxuICAgIHJldHVybiB0aGlzLm1fbGVuZ3RoQTtcclxuICB9XHJcblxyXG4gIEdldExlbmd0aEIoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5tX2xlbmd0aEI7XHJcbiAgfVxyXG5cclxuICBHZXRSYXRpbygpIHtcclxuICAgIHJldHVybiB0aGlzLm1fcmF0aW87XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHN0YXRpYyBHZXRDdXJyZW50TGVuZ3RoQV9zX3AgPSBuZXcgYjJWZWMyKCk7XHJcblxyXG4gIEdldEN1cnJlbnRMZW5ndGhBKCkge1xyXG4gICAgLy8gYjJWZWMyIHAgPSBtX2JvZHlBLT5HZXRXb3JsZFBvaW50KG1fbG9jYWxBbmNob3JBKTtcclxuICAgIC8vIGIyVmVjMiBzID0gbV9ncm91bmRBbmNob3JBO1xyXG4gICAgLy8gYjJWZWMyIGQgPSBwIC0gcztcclxuICAgIC8vIHJldHVybiBkLkxlbmd0aCgpO1xyXG4gICAgY29uc3QgcCA9IHRoaXMubV9ib2R5QS5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEsIGIyUHVsbGV5Sm9pbnQuR2V0Q3VycmVudExlbmd0aEFfc19wKTtcclxuICAgIGNvbnN0IHMgPSB0aGlzLm1fZ3JvdW5kQW5jaG9yQTtcclxuICAgIHJldHVybiBiMlZlYzIuRGlzdGFuY2VWVihwLCBzKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIEdldEN1cnJlbnRMZW5ndGhCX3NfcCA9IG5ldyBiMlZlYzIoKTtcclxuXHJcbiAgR2V0Q3VycmVudExlbmd0aEIoKSB7XHJcbiAgICAvLyBiMlZlYzIgcCA9IG1fYm9keUItPkdldFdvcmxkUG9pbnQobV9sb2NhbEFuY2hvckIpO1xyXG4gICAgLy8gYjJWZWMyIHMgPSBtX2dyb3VuZEFuY2hvckI7XHJcbiAgICAvLyBiMlZlYzIgZCA9IHAgLSBzO1xyXG4gICAgLy8gcmV0dXJuIGQuTGVuZ3RoKCk7XHJcbiAgICBjb25zdCBwID0gdGhpcy5tX2JvZHlCLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQiwgYjJQdWxsZXlKb2ludC5HZXRDdXJyZW50TGVuZ3RoQl9zX3ApO1xyXG4gICAgY29uc3QgcyA9IHRoaXMubV9ncm91bmRBbmNob3JCO1xyXG4gICAgcmV0dXJuIGIyVmVjMi5EaXN0YW5jZVZWKHAsIHMpO1xyXG4gIH1cclxuXHJcbiAgU2hpZnRPcmlnaW4obmV3T3JpZ2luOiBiMlZlYzIpIHtcclxuICAgIHRoaXMubV9ncm91bmRBbmNob3JBLlNlbGZTdWIobmV3T3JpZ2luKTtcclxuICAgIHRoaXMubV9ncm91bmRBbmNob3JCLlNlbGZTdWIobmV3T3JpZ2luKTtcclxuICB9XHJcbn1cclxuIl19