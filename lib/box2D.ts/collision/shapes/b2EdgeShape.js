/*
 * Copyright (c) 2006-2010 Erin Catto http://www.box2d.org
 *
 * This software is provided 'as-is', without any express or implied
 * warranty.  In no event will the authors be held liable for any damages
 * arising from the use of this software.
 * Permission is granted to anyone to use this software for any purpose,
 * including commercial applications, and to alter it and redistribute it
 * freely, subject to the following restrictions:
 * 1. The origin of this software must not be misrepresented; you must not
 * claim that you wrote the original software. If you use this software
 * in a product, an acknowledgment in the product documentation would be
 * appreciated but is not required.
 * 2. Altered source versions must be plainly marked as such, and must not be
 * misrepresented as being the original software.
 * 3. This notice may not be removed or altered from any source distribution.
 */
import { b2_polygonRadius, b2Assert } from '../../common/b2Settings';
import { b2Rot, b2Transform, b2Vec2 } from '../../common/b2Math';
import { b2Shape } from './b2Shape';
/// @see b2Shape::ComputeDistance
const ComputeDistance_s_v1 = new b2Vec2();
const ComputeDistance_s_v2 = new b2Vec2();
const ComputeDistance_s_d = new b2Vec2();
const ComputeDistance_s_s = new b2Vec2();
/// A line segment (edge) shape. These can be connected in chains or loops
/// to other edge shapes. The connectivity information is used to ensure
/// correct contact normals.
export class b2EdgeShape extends b2Shape {
    constructor() {
        super(1 /* e_edgeShape */, b2_polygonRadius);
        this.m_vertex1 = new b2Vec2();
        this.m_vertex2 = new b2Vec2();
        this.m_vertex0 = new b2Vec2();
        this.m_vertex3 = new b2Vec2();
        this.m_hasVertex0 = false;
        this.m_hasVertex3 = false;
    }
    /// Set this as an isolated edge.
    Set(v1, v2) {
        this.m_vertex1.Copy(v1);
        this.m_vertex2.Copy(v2);
        this.m_hasVertex0 = false;
        this.m_hasVertex3 = false;
        return this;
    }
    /// Implement b2Shape.
    Clone() {
        return new b2EdgeShape().Copy(this);
    }
    Copy(other) {
        super.Copy(other);
        !!B2_DEBUG && b2Assert(other instanceof b2EdgeShape);
        this.m_vertex1.Copy(other.m_vertex1);
        this.m_vertex2.Copy(other.m_vertex2);
        this.m_vertex0.Copy(other.m_vertex0);
        this.m_vertex3.Copy(other.m_vertex3);
        this.m_hasVertex0 = other.m_hasVertex0;
        this.m_hasVertex3 = other.m_hasVertex3;
        return this;
    }
    /// @see b2Shape::GetChildCount
    GetChildCount() {
        return 1;
    }
    /// @see b2Shape::TestPoint
    TestPoint(xf, p) {
        return false;
    }
    ComputeDistance(xf, p, normal, childIndex) {
        if (B2_ENABLE_PARTICLE) {
            const v1 = b2Transform.MulXV(xf, this.m_vertex1, ComputeDistance_s_v1);
            const v2 = b2Transform.MulXV(xf, this.m_vertex2, ComputeDistance_s_v2);
            const d = b2Vec2.SubVV(p, v1, ComputeDistance_s_d);
            const s = b2Vec2.SubVV(v2, v1, ComputeDistance_s_s);
            const ds = b2Vec2.DotVV(d, s);
            if (ds > 0) {
                const s2 = b2Vec2.DotVV(s, s);
                if (ds > s2) {
                    b2Vec2.SubVV(p, v2, d);
                }
                else {
                    d.SelfMulSub(ds / s2, s);
                }
            }
            normal.Copy(d);
            return normal.Normalize();
        }
        else {
            return 0.0;
        }
    }
    RayCast(output, input, xf, childIndex) {
        // Put the ray into the edge's frame of reference.
        const p1 = b2Transform.MulTXV(xf, input.p1, b2EdgeShape.RayCast_s_p1);
        const p2 = b2Transform.MulTXV(xf, input.p2, b2EdgeShape.RayCast_s_p2);
        const d = b2Vec2.SubVV(p2, p1, b2EdgeShape.RayCast_s_d);
        const v1 = this.m_vertex1;
        const v2 = this.m_vertex2;
        const e = b2Vec2.SubVV(v2, v1, b2EdgeShape.RayCast_s_e);
        const normal = output.normal.Set(e.y, -e.x).SelfNormalize();
        // q = p1 + t * d
        // dot(normal, q - v1) = 0
        // dot(normal, p1 - v1) + t * dot(normal, d) = 0
        const numerator = b2Vec2.DotVV(normal, b2Vec2.SubVV(v1, p1, b2Vec2.s_t0));
        const denominator = b2Vec2.DotVV(normal, d);
        if (denominator === 0) {
            return false;
        }
        const t = numerator / denominator;
        if (t < 0 || input.maxFraction < t) {
            return false;
        }
        const q = b2Vec2.AddVMulSV(p1, t, d, b2EdgeShape.RayCast_s_q);
        // q = v1 + s * r
        // s = dot(q - v1, r) / dot(r, r)
        const r = b2Vec2.SubVV(v2, v1, b2EdgeShape.RayCast_s_r);
        const rr = b2Vec2.DotVV(r, r);
        if (rr === 0) {
            return false;
        }
        const s = b2Vec2.DotVV(b2Vec2.SubVV(q, v1, b2Vec2.s_t0), r) / rr;
        if (s < 0 || 1 < s) {
            return false;
        }
        output.fraction = t;
        b2Rot.MulRV(xf.q, output.normal, output.normal);
        if (numerator > 0) {
            output.normal.SelfNeg();
        }
        return true;
    }
    ComputeAABB(aabb, xf, childIndex) {
        const v1 = b2Transform.MulXV(xf, this.m_vertex1, b2EdgeShape.ComputeAABB_s_v1);
        const v2 = b2Transform.MulXV(xf, this.m_vertex2, b2EdgeShape.ComputeAABB_s_v2);
        b2Vec2.MinV(v1, v2, aabb.lowerBound);
        b2Vec2.MaxV(v1, v2, aabb.upperBound);
        const r = this.m_radius;
        aabb.lowerBound.SelfSubXY(r, r);
        aabb.upperBound.SelfAddXY(r, r);
    }
    /// @see b2Shape::ComputeMass
    ComputeMass(massData, density) {
        massData.mass = 0;
        b2Vec2.MidVV(this.m_vertex1, this.m_vertex2, massData.center);
        massData.I = 0;
    }
    SetupDistanceProxy(proxy, index) {
        proxy.m_vertices = proxy.m_buffer;
        proxy.m_vertices[0].Copy(this.m_vertex1);
        proxy.m_vertices[1].Copy(this.m_vertex2);
        proxy.m_count = 2;
        proxy.m_radius = this.m_radius;
    }
    ComputeSubmergedArea(normal, offset, xf, c) {
        c.SetZero();
        return 0;
    }
}
/// Implement b2Shape.
// p = p1 + t * d
// v = v1 + s * e
// p1 + t * d = v1 + s * e
// s * e - t * d = p1 - v1
b2EdgeShape.RayCast_s_p1 = new b2Vec2();
b2EdgeShape.RayCast_s_p2 = new b2Vec2();
b2EdgeShape.RayCast_s_d = new b2Vec2();
b2EdgeShape.RayCast_s_e = new b2Vec2();
b2EdgeShape.RayCast_s_q = new b2Vec2();
b2EdgeShape.RayCast_s_r = new b2Vec2();
/// @see b2Shape::ComputeAABB
b2EdgeShape.ComputeAABB_s_v1 = new b2Vec2();
b2EdgeShape.ComputeAABB_s_v2 = new b2Vec2();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYjJFZGdlU2hhcGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29sbGlzaW9uL3NoYXBlcy9iMkVkZ2VTaGFwZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7OztHQWdCRztBQUVILE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxRQUFRLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUNyRSxPQUFPLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQU0sTUFBTSxxQkFBcUIsQ0FBQztBQUdyRSxPQUFPLEVBQWMsT0FBTyxFQUFlLE1BQU0sV0FBVyxDQUFDO0FBRTdELGlDQUFpQztBQUNqQyxNQUFNLG9CQUFvQixHQUFHLElBQUksTUFBTSxFQUFFLENBQUM7QUFDMUMsTUFBTSxvQkFBb0IsR0FBRyxJQUFJLE1BQU0sRUFBRSxDQUFDO0FBQzFDLE1BQU0sbUJBQW1CLEdBQUcsSUFBSSxNQUFNLEVBQUUsQ0FBQztBQUN6QyxNQUFNLG1CQUFtQixHQUFHLElBQUksTUFBTSxFQUFFLENBQUM7QUFFekMsMEVBQTBFO0FBQzFFLHdFQUF3RTtBQUN4RSw0QkFBNEI7QUFDNUIsTUFBTSxPQUFPLFdBQVksU0FBUSxPQUFPO0lBUXRDO1FBQ0UsS0FBSyxzQkFBMEIsZ0JBQWdCLENBQUMsQ0FBQztRQVIxQyxjQUFTLEdBQVcsSUFBSSxNQUFNLEVBQUUsQ0FBQztRQUNqQyxjQUFTLEdBQVcsSUFBSSxNQUFNLEVBQUUsQ0FBQztRQUNqQyxjQUFTLEdBQVcsSUFBSSxNQUFNLEVBQUUsQ0FBQztRQUNqQyxjQUFTLEdBQVcsSUFBSSxNQUFNLEVBQUUsQ0FBQztRQUMxQyxpQkFBWSxHQUFHLEtBQUssQ0FBQztRQUNyQixpQkFBWSxHQUFHLEtBQUssQ0FBQztJQUlyQixDQUFDO0lBRUQsaUNBQWlDO0lBQ2pDLEdBQUcsQ0FBQyxFQUFNLEVBQUUsRUFBTTtRQUNoQixJQUFJLENBQUMsU0FBUyxDQUFDLElBQUks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LFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ3pDLEtBQUssQ0FBQyxPQUFPLEdBQUcsQ0FBQyxDQUFDO1FBQ2xCLEtBQUssQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQztJQUNqQyxDQUFDO0lBRUQsb0JBQW9CLENBQUMsTUFBYyxFQUFFLE1BQWMsRUFBRSxFQUFlLEVBQUUsQ0FBUztRQUM3RSxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDWixPQUFPLENBQUMsQ0FBQztJQUNYLENBQUM7O0FBcEdELHNCQUFzQjtBQUN0QixpQkFBaUI7QUFDakIsaUJBQWlCO0FBQ2pCLDBCQUEwQjtBQUMxQiwwQkFBMEI7QUFDWCx3QkFBWSxHQUFHLElBQUksTUFBTSxFQUFFLENBQUM7QUFDNUIsd0JBQVksR0FBRyxJQUFJLE1BQU0sRUFBRSxDQUFDO0FBQzVCLHVCQUFXLEdBQUcsSUFBSSxNQUFNLEVBQUUsQ0FBQztBQUMzQix1QkFBVyxHQUFHLElBQUksTUFBTSxFQUFFLENBQUM7QUFDM0IsdUJBQVcsR0FBRyxJQUFJLE1BQU0sRUFBRSxDQUFDO0FBQzNCLHVCQUFXLEdBQUcsSUFBSSxNQUFNLEVBQUUsQ0FBQztBQXdEMUMsNkJBQTZCO0FBQ2QsNEJBQWdCLEdBQUcsSUFBSSxNQUFNLEVBQUUsQ0FBQztBQUNoQyw0QkFBZ0IsR0FBRyxJQUFJLE1BQU0sRUFBRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogQ29weXJpZ2h0IChjKSAyMDA2LTIwMTAgRXJpbiBDYXR0byBodHRwOi8vd3d3LmJveDJkLm9yZ1xyXG4gKlxyXG4gKiBUaGlzIHNvZnR3YXJlIGlzIHByb3ZpZGVkICdhcy1pcycsIHdpdGhvdXQgYW55IGV4cHJlc3Mgb3IgaW1wbGllZFxyXG4gKiB3YXJyYW50eS4gIEluIG5vIGV2ZW50IHdpbGwgdGhlIGF1dGhvcnMgYmUgaGVsZCBsaWFibGUgZm9yIGFueSBkYW1hZ2VzXHJcbiAqIGFyaXNpbmcgZnJvbSB0aGUgdXNlIG9mIHRoaXMgc29mdHdhcmUuXHJcbiAqIFBlcm1pc3Npb24gaXMgZ3JhbnRlZCB0byBhbnlvbmUgdG8gdXNlIHRoaXMgc29mdHdhcmUgZm9yIGFueSBwdXJwb3NlLFxyXG4gKiBpbmNsdWRpbmcgY29tbWVyY2lhbCBhcHBsaWNhdGlvbnMsIGFuZCB0byBhbHRlciBpdCBhbmQgcmVkaXN0cmlidXRlIGl0XHJcbiAqIGZyZWVseSwgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIHJlc3RyaWN0aW9uczpcclxuICogMS4gVGhlIG9yaWdpbiBvZiB0aGlzIHNvZnR3YXJlIG11c3Qgbm90IGJlIG1pc3JlcHJlc2VudGVkOyB5b3UgbXVzdCBub3RcclxuICogY2xhaW0gdGhhdCB5b3Ugd3JvdGUgdGhlIG9yaWdpbmFsIHNvZnR3YXJlLiBJZiB5b3UgdXNlIHRoaXMgc29mdHdhcmVcclxuICogaW4gYSBwcm9kdWN0LCBhbiBhY2tub3dsZWRnbWVudCBpbiB0aGUgcHJvZHVjdCBkb2N1bWVudGF0aW9uIHdvdWxkIGJlXHJcbiAqIGFwcHJlY2lhdGVkIGJ1dCBpcyBub3QgcmVxdWlyZWQuXHJcbiAqIDIuIEFsdGVyZWQgc291cmNlIHZlcnNpb25zIG11c3QgYmUgcGxhaW5seSBtYXJrZWQgYXMgc3VjaCwgYW5kIG11c3Qgbm90IGJlXHJcbiAqIG1pc3JlcHJlc2VudGVkIGFzIGJlaW5nIHRoZSBvcmlnaW5hbCBzb2Z0d2FyZS5cclxuICogMy4gVGhpcyBub3RpY2UgbWF5IG5vdCBiZSByZW1vdmVkIG9yIGFsdGVyZWQgZnJvbSBhbnkgc291cmNlIGRpc3RyaWJ1dGlvbi5cclxuICovXHJcblxyXG5pbXBvcnQgeyBiMl9wb2x5Z29uUmFkaXVzLCBiMkFzc2VydCB9IGZyb20gJy4uLy4uL2NvbW1vbi9iMlNldHRpbmdzJztcclxuaW1wb3J0IHsgYjJSb3QsIGIyVHJhbnNmb3JtLCBiMlZlYzIsIFhZIH0gZnJvbSAnLi4vLi4vY29tbW9uL2IyTWF0aCc7XHJcbmltcG9ydCB7IGIyQUFCQiwgYjJSYXlDYXN0SW5wdXQsIGIyUmF5Q2FzdE91dHB1dCB9IGZyb20gJy4uL2IyQ29sbGlzaW9uJztcclxuaW1wb3J0IHsgYjJEaXN0YW5jZVByb3h5IH0gZnJvbSAnLi4vYjJEaXN0YW5jZSc7XHJcbmltcG9ydCB7IGIyTWFzc0RhdGEsIGIyU2hhcGUsIGIyU2hhcGVUeXBlIH0gZnJvbSAnLi9iMlNoYXBlJztcclxuXHJcbi8vLyBAc2VlIGIyU2hhcGU6OkNvbXB1dGVEaXN0YW5jZVxyXG5jb25zdCBDb21wdXRlRGlzdGFuY2Vfc192MSA9IG5ldyBiMlZlYzIoKTtcclxuY29uc3QgQ29tcHV0ZURpc3RhbmNlX3NfdjIgPSBuZXcgYjJWZWMyKCk7XHJcbmNvbnN0IENvbXB1dGVEaXN0YW5jZV9zX2QgPSBuZXcgYjJWZWMyKCk7XHJcbmNvbnN0IENvbXB1dGVEaXN0YW5jZV9zX3MgPSBuZXcgYjJWZWMyKCk7XHJcblxyXG4vLy8gQSBsaW5lIHNlZ21lbnQgKGVkZ2UpIHNoYXBlLiBUaGVzZSBjYW4gYmUgY29ubmVjdGVkIGluIGNoYWlucyBvciBsb29wc1xyXG4vLy8gdG8gb3RoZXIgZWRnZSBzaGFwZXMuIFRoZSBjb25uZWN0aXZpdHkgaW5mb3JtYXRpb24gaXMgdXNlZCB0byBlbnN1cmVcclxuLy8vIGNvcnJlY3QgY29udGFjdCBub3JtYWxzLlxyXG5leHBvcnQgY2xhc3MgYjJFZGdlU2hhcGUgZXh0ZW5kcyBiMlNoYXBlIHtcclxuICByZWFkb25seSBtX3ZlcnRleDE6IGIyVmVjMiA9IG5ldyBiMlZlYzIoKTtcclxuICByZWFkb25seSBtX3ZlcnRleDI6IGIyVmVjMiA9IG5ldyBiMlZlYzIoKTtcclxuICByZWFkb25seSBtX3ZlcnRleDA6IGIyVmVjMiA9IG5ldyBiMlZlYzIoKTtcclxuICByZWFkb25seSBtX3ZlcnRleDM6IGIyVmVjMiA9IG5ldyBiMlZlYzIoKTtcclxuICBtX2hhc1ZlcnRleDAgPSBmYWxzZTtcclxuICBtX2hhc1ZlcnRleDMgPSBmYWxzZTtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICBzdXBlcihiMlNoYXBlVHlwZS5lX2VkZ2VTaGFwZSwgYjJfcG9seWdvblJhZGl1cyk7XHJcbiAgfVxyXG5cclxuICAvLy8gU2V0IHRoaXMgYXMgYW4gaXNvbGF0ZWQgZWRnZS5cclxuICBTZXQodjE6IFhZLCB2MjogWFkpOiBiMkVkZ2VTaGFwZSB7XHJcbiAgICB0aGlzLm1fdmVydGV4MS5Db3B5KHYxKTtcclxuICAgIHRoaXMubV92ZXJ0ZXgyLkNvcHkodjIpO1xyXG4gICAgdGhpcy5tX2hhc1ZlcnRleDAgPSBmYWxzZTtcclxuICAgIHRoaXMubV9oYXNWZXJ0ZXgzID0gZmFsc2U7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIC8vLyBJbXBsZW1lbnQgYjJTaGFwZS5cclxuICBDbG9uZSgpOiBiMkVkZ2VTaGFwZSB7XHJcbiAgICByZXR1cm4gbmV3IGIyRWRnZVNoYXBlKCkuQ29weSh0aGlzKTtcclxuICB9XHJcblxyXG4gIENvcHkob3RoZXI6IGIyRWRnZVNoYXBlKTogYjJFZGdlU2hhcGUge1xyXG4gICAgc3VwZXIuQ29weShvdGhlcik7XHJcblxyXG4gICAgISFCMl9ERUJVRyAmJiBiMkFzc2VydChvdGhlciBpbnN0YW5jZW9mIGIyRWRnZVNoYXBlKTtcclxuXHJcbiAgICB0aGlzLm1fdmVydGV4MS5Db3B5KG90aGVyLm1fdmVydGV4MSk7XHJcbiAgICB0aGlzLm1fdmVydGV4Mi5Db3B5KG90aGVyLm1fdmVydGV4Mik7XHJcbiAgICB0aGlzLm1fdmVydGV4MC5Db3B5KG90aGVyLm1fdmVydGV4MCk7XHJcbiAgICB0aGlzLm1fdmVydGV4My5Db3B5KG90aGVyLm1fdmVydGV4Myk7XHJcbiAgICB0aGlzLm1faGFzVmVydGV4MCA9IG90aGVyLm1faGFzVmVydGV4MDtcclxuICAgIHRoaXMubV9oYXNWZXJ0ZXgzID0gb3RoZXIubV9oYXNWZXJ0ZXgzO1xyXG5cclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgLy8vIEBzZWUgYjJTaGFwZTo6R2V0Q2hpbGRDb3VudFxyXG4gIEdldENoaWxkQ291bnQoKTogbnVtYmVyIHtcclxuICAgIHJldHVybiAxO1xyXG4gIH1cclxuXHJcbiAgLy8vIEBzZWUgYjJTaGFwZTo6VGVzdFBvaW50XHJcbiAgVGVzdFBvaW50KHhmOiBiMlRyYW5zZm9ybSwgcDogWFkpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIENvbXB1dGVEaXN0YW5jZSh4ZjogYjJUcmFuc2Zvcm0sIHA6IGIyVmVjMiwgbm9ybWFsOiBiMlZlYzIsIGNoaWxkSW5kZXg6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICBpZiAoQjJfRU5BQkxFX1BBUlRJQ0xFKSB7XHJcbiAgICAgIGNvbnN0IHYxID0gYjJUcmFuc2Zvcm0uTXVsWFYoeGYsIHRoaXMubV92ZXJ0ZXgxLCBDb21wdXRlRGlzdGFuY2Vfc192MSk7XHJcbiAgICAgIGNvbnN0IHYyID0gYjJUcmFuc2Zvcm0uTXVsWFYoeGYsIHRoaXMubV92ZXJ0ZXgyLCBDb21wdXRlRGlzdGFuY2Vfc192Mik7XHJcblxyXG4gICAgICBjb25zdCBkID0gYjJWZWMyLlN1YlZWKHAsIHYxLCBDb21wdXRlRGlzdGFuY2Vfc19kKTtcclxuICAgICAgY29uc3QgcyA9IGIyVmVjMi5TdWJWVih2MiwgdjEsIENvbXB1dGVEaXN0YW5jZV9zX3MpO1xyXG4gICAgICBjb25zdCBkcyA9IGIyVmVjMi5Eb3RWVihkLCBzKTtcclxuICAgICAgaWYgKGRzID4gMCkge1xyXG4gICAgICAgIGNvbnN0IHMyID0gYjJWZWMyLkRvdFZWKHMsIHMpO1xyXG4gICAgICAgIGlmIChkcyA+IHMyKSB7XHJcbiAgICAgICAgICBiMlZlYzIuU3ViVlYocCwgdjIsIGQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBkLlNlbGZNdWxTdWIoZHMgLyBzMiwgcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIG5vcm1hbC5Db3B5KGQpO1xyXG4gICAgICByZXR1cm4gbm9ybWFsLk5vcm1hbGl6ZSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIDAuMDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vLyBJbXBsZW1lbnQgYjJTaGFwZS5cclxuICAvLyBwID0gcDEgKyB0ICogZFxyXG4gIC8vIHYgPSB2MSArIHMgKiBlXHJcbiAgLy8gcDEgKyB0ICogZCA9IHYxICsgcyAqIGVcclxuICAvLyBzICogZSAtIHQgKiBkID0gcDEgLSB2MVxyXG4gIHByaXZhdGUgc3RhdGljIFJheUNhc3Rfc19wMSA9IG5ldyBiMlZlYzIoKTtcclxuICBwcml2YXRlIHN0YXRpYyBSYXlDYXN0X3NfcDIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgcHJpdmF0ZSBzdGF0aWMgUmF5Q2FzdF9zX2QgPSBuZXcgYjJWZWMyKCk7XHJcbiAgcHJpdmF0ZSBzdGF0aWMgUmF5Q2FzdF9zX2UgPSBuZXcgYjJWZWMyKCk7XHJcbiAgcHJpdmF0ZSBzdGF0aWMgUmF5Q2FzdF9zX3EgPSBuZXcgYjJWZWMyKCk7XHJcbiAgcHJpdmF0ZSBzdGF0aWMgUmF5Q2FzdF9zX3IgPSBuZXcgYjJWZWMyKCk7XHJcblxyXG4gIFJheUNhc3QoXHJcbiAgICBvdXRwdXQ6IGIyUmF5Q2FzdE91dHB1dCxcclxuICAgIGlucHV0OiBiMlJheUNhc3RJbnB1dCxcclxuICAgIHhmOiBiMlRyYW5zZm9ybSxcclxuICAgIGNoaWxkSW5kZXg6IG51bWJlcixcclxuICApOiBib29sZWFuIHtcclxuICAgIC8vIFB1dCB0aGUgcmF5IGludG8gdGhlIGVkZ2UncyBmcmFtZSBvZiByZWZlcmVuY2UuXHJcbiAgICBjb25zdCBwMTogYjJWZWMyID0gYjJUcmFuc2Zvcm0uTXVsVFhWKHhmLCBpbnB1dC5wMSwgYjJFZGdlU2hhcGUuUmF5Q2FzdF9zX3AxKTtcclxuICAgIGNvbnN0IHAyOiBiMlZlYzIgPSBiMlRyYW5zZm9ybS5NdWxUWFYoeGYsIGlucHV0LnAyLCBiMkVkZ2VTaGFwZS5SYXlDYXN0X3NfcDIpO1xyXG4gICAgY29uc3QgZDogYjJWZWMyID0gYjJWZWMyLlN1YlZWKHAyLCBwMSwgYjJFZGdlU2hhcGUuUmF5Q2FzdF9zX2QpO1xyXG5cclxuICAgIGNvbnN0IHYxOiBiMlZlYzIgPSB0aGlzLm1fdmVydGV4MTtcclxuICAgIGNvbnN0IHYyOiBiMlZlYzIgPSB0aGlzLm1fdmVydGV4MjtcclxuICAgIGNvbnN0IGU6IGIyVmVjMiA9IGIyVmVjMi5TdWJWVih2MiwgdjEsIGIyRWRnZVNoYXBlLlJheUNhc3Rfc19lKTtcclxuICAgIGNvbnN0IG5vcm1hbDogYjJWZWMyID0gb3V0cHV0Lm5vcm1hbC5TZXQoZS55LCAtZS54KS5TZWxmTm9ybWFsaXplKCk7XHJcblxyXG4gICAgLy8gcSA9IHAxICsgdCAqIGRcclxuICAgIC8vIGRvdChub3JtYWwsIHEgLSB2MSkgPSAwXHJcbiAgICAvLyBkb3Qobm9ybWFsLCBwMSAtIHYxKSArIHQgKiBkb3Qobm9ybWFsLCBkKSA9IDBcclxuICAgIGNvbnN0IG51bWVyYXRvcjogbnVtYmVyID0gYjJWZWMyLkRvdFZWKG5vcm1hbCwgYjJWZWMyLlN1YlZWKHYxLCBwMSwgYjJWZWMyLnNfdDApKTtcclxuICAgIGNvbnN0IGRlbm9taW5hdG9yOiBudW1iZXIgPSBiMlZlYzIuRG90VlYobm9ybWFsLCBkKTtcclxuXHJcbiAgICBpZiAoZGVub21pbmF0b3IgPT09IDApIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHQ6IG51bWJlciA9IG51bWVyYXRvciAvIGRlbm9taW5hdG9yO1xyXG4gICAgaWYgKHQgPCAwIHx8IGlucHV0Lm1heEZyYWN0aW9uIDwgdCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcTogYjJWZWMyID0gYjJWZWMyLkFkZFZNdWxTVihwMSwgdCwgZCwgYjJFZGdlU2hhcGUuUmF5Q2FzdF9zX3EpO1xyXG5cclxuICAgIC8vIHEgPSB2MSArIHMgKiByXHJcbiAgICAvLyBzID0gZG90KHEgLSB2MSwgcikgLyBkb3QociwgcilcclxuICAgIGNvbnN0IHI6IGIyVmVjMiA9IGIyVmVjMi5TdWJWVih2MiwgdjEsIGIyRWRnZVNoYXBlLlJheUNhc3Rfc19yKTtcclxuICAgIGNvbnN0IHJyOiBudW1iZXIgPSBiMlZlYzIuRG90VlYociwgcik7XHJcbiAgICBpZiAocnIgPT09IDApIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHM6IG51bWJlciA9IGIyVmVjMi5Eb3RWVihiMlZlYzIuU3ViVlYocSwgdjEsIGIyVmVjMi5zX3QwKSwgcikgLyBycjtcclxuICAgIGlmIChzIDwgMCB8fCAxIDwgcykge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgb3V0cHV0LmZyYWN0aW9uID0gdDtcclxuICAgIGIyUm90Lk11bFJWKHhmLnEsIG91dHB1dC5ub3JtYWwsIG91dHB1dC5ub3JtYWwpO1xyXG4gICAgaWYgKG51bWVyYXRvciA+IDApIHtcclxuICAgICAgb3V0cHV0Lm5vcm1hbC5TZWxmTmVnKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8vLyBAc2VlIGIyU2hhcGU6OkNvbXB1dGVBQUJCXHJcbiAgcHJpdmF0ZSBzdGF0aWMgQ29tcHV0ZUFBQkJfc192MSA9IG5ldyBiMlZlYzIoKTtcclxuICBwcml2YXRlIHN0YXRpYyBDb21wdXRlQUFCQl9zX3YyID0gbmV3IGIyVmVjMigpO1xyXG5cclxuICBDb21wdXRlQUFCQihhYWJiOiBiMkFBQkIsIHhmOiBiMlRyYW5zZm9ybSwgY2hpbGRJbmRleDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBjb25zdCB2MTogYjJWZWMyID0gYjJUcmFuc2Zvcm0uTXVsWFYoeGYsIHRoaXMubV92ZXJ0ZXgxLCBiMkVkZ2VTaGFwZS5Db21wdXRlQUFCQl9zX3YxKTtcclxuICAgIGNvbnN0IHYyOiBiMlZlYzIgPSBiMlRyYW5zZm9ybS5NdWxYVih4ZiwgdGhpcy5tX3ZlcnRleDIsIGIyRWRnZVNoYXBlLkNvbXB1dGVBQUJCX3NfdjIpO1xyXG5cclxuICAgIGIyVmVjMi5NaW5WKHYxLCB2MiwgYWFiYi5sb3dlckJvdW5kKTtcclxuICAgIGIyVmVjMi5NYXhWKHYxLCB2MiwgYWFiYi51cHBlckJvdW5kKTtcclxuXHJcbiAgICBjb25zdCByOiBudW1iZXIgPSB0aGlzLm1fcmFkaXVzO1xyXG4gICAgYWFiYi5sb3dlckJvdW5kLlNlbGZTdWJYWShyLCByKTtcclxuICAgIGFhYmIudXBwZXJCb3VuZC5TZWxmQWRkWFkociwgcik7XHJcbiAgfVxyXG5cclxuICAvLy8gQHNlZSBiMlNoYXBlOjpDb21wdXRlTWFzc1xyXG4gIENvbXB1dGVNYXNzKG1hc3NEYXRhOiBiMk1hc3NEYXRhLCBkZW5zaXR5OiBudW1iZXIpOiB2b2lkIHtcclxuICAgIG1hc3NEYXRhLm1hc3MgPSAwO1xyXG4gICAgYjJWZWMyLk1pZFZWKHRoaXMubV92ZXJ0ZXgxLCB0aGlzLm1fdmVydGV4MiwgbWFzc0RhdGEuY2VudGVyKTtcclxuICAgIG1hc3NEYXRhLkkgPSAwO1xyXG4gIH1cclxuXHJcbiAgU2V0dXBEaXN0YW5jZVByb3h5KHByb3h5OiBiMkRpc3RhbmNlUHJveHksIGluZGV4OiBudW1iZXIpOiB2b2lkIHtcclxuICAgIHByb3h5Lm1fdmVydGljZXMgPSBwcm94eS5tX2J1ZmZlcjtcclxuICAgIHByb3h5Lm1fdmVydGljZXNbMF0uQ29weSh0aGlzLm1fdmVydGV4MSk7XHJcbiAgICBwcm94eS5tX3ZlcnRpY2VzWzFdLkNvcHkodGhpcy5tX3ZlcnRleDIpO1xyXG4gICAgcHJveHkubV9jb3VudCA9IDI7XHJcbiAgICBwcm94eS5tX3JhZGl1cyA9IHRoaXMubV9yYWRpdXM7XHJcbiAgfVxyXG5cclxuICBDb21wdXRlU3VibWVyZ2VkQXJlYShub3JtYWw6IGIyVmVjMiwgb2Zmc2V0OiBudW1iZXIsIHhmOiBiMlRyYW5zZm9ybSwgYzogYjJWZWMyKTogbnVtYmVyIHtcclxuICAgIGMuU2V0WmVybygpO1xyXG4gICAgcmV0dXJuIDA7XHJcbiAgfVxyXG59XHJcbiJdfQ==